{"ast":null,"code":"var _jsxFileName = \"D:\\\\fashion-shirt-shop\\\\DATN\\\\src\\\\main\\\\resources\\\\templates\\\\fashionshop-ui\\\\src\\\\layouts\\\\admin\\\\HoaDon\\\\pages\\\\OrderDetailPage.jsx\",\n  _s = $RefreshSig$();\n// src/layouts/HoaDon/OrderDetailPage/index.jsx\n\nimport React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\n// === IMPORT LAYOUT COMPONENTS ===\nimport DashboardLayout from \"../../../../examples/LayoutContainers/DashboardLayout\";\nimport DashboardNavbar from \"../../../../examples/Navbars/DashboardNavbar\";\nimport Footer from \"../../../../examples/Footer\";\n\n// === IMPORT CÁC COMPONENT TỪ @mui/material VÀ SOFT UI ===\nimport SoftBox from \"../../../../components/SoftBox\";\nimport SoftTypography from \"../../../../components/SoftTypography\";\nimport Card from \"@mui/material/Card\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Alert from \"@mui/material/Alert\";\nimport SoftButton from \"../../../../components/SoftButton\";\nimport OrderHistory from \"../OrderDetail/OrderHistory\";\nimport OrderInfo from \"../OrderDetail/OrderInfo\";\nimport PaymentHistory from \"../OrderDetail/PaymentHistory\";\nimport ProductList from \"../OrderDetail/ProductList\";\nimport OrderSummary from \"../OrderDetail/OrderSummary\";\nimport OrderHistoryModal from \"../OrderHistoryModal/OrderHistoryModal\";\nimport CancelOrderDialog from \"../OrderDetail/CancelOrderDialog/CancelOrderDialog\";\nimport UpdateOrderInfo from \"../UpdateOrderInfo/UpdateOrderInfo\";\nimport { useReactToPrint } from \"react-to-print\";\nimport { toast } from \"react-toastify\";\nimport InHoaDon from \"../InHoaDon/InHoaDon.jsx\";\nimport PropTypes from \"prop-types\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst statusMap = {\n  HOAN_THANH: \"Hoàn thành\",\n  CHO_XAC_NHAN: \"Chờ xác nhận\",\n  DANG_GIAO: \"Đang giao\",\n  DA_XAC_NHAN: \"Đã xác nhận\",\n  HUY: \"Đã hủy\",\n  CHO_THANH_TOAN: \"Chờ thanh toán\",\n  DA_THANH_TOAN: \"Đã thanh toán\",\n  CHO_GIAO_HANG: \"Chờ giao hàng\",\n  DANG_VAN_CHUYEN: \"Đang vận chuyển\",\n  TAO_DON_HANG: \"Tạo đơn hàng\"\n};\nconst paymentStatusMap = {\n  HOAN_THANH: \"Đã thanh toán\",\n  CHO_XAC_NHAN: \"Chờ thanh toán\"\n};\nconst orderTypeMap = {\n  tai_quay: \"Tại quầy\",\n  giao_hang: \"Giao hàng\",\n  online: \"Trực tuyến\"\n};\nconst mapStatus = apiStatus => statusMap[apiStatus] || apiStatus;\nconst mapPaymentStatus = apiStatus => paymentStatusMap[apiStatus] || apiStatus;\nconst mapOrderType = apiType => orderTypeMap[apiType] || apiType;\nconst OrderDetailPage = () => {\n  _s();\n  // === HOOKS VÀ STATE ===\n  const {\n    orderId\n  } = useParams();\n  const [orderData, setOrderData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\n  const [actionLoading, setActionLoading] = useState(false);\n  const [actionError, setActionError] = useState(null);\n  const [nguoiThucHienAction] = useState(\"Admin\");\n  const [showUpdateModal, setShowUpdateModal] = useState(false);\n  const componentRef = useRef();\n  const [isCancelling, setIsCancelling] = useState(false);\n  // === HÀM XỬ LÝ ===\n  const handleShowHistoryModal = () => setShowHistoryModal(true);\n  const handleCloseHistoryModal = () => setShowHistoryModal(false);\n  const handleOpenUpdateModal = () => setShowUpdateModal(true);\n  const handleCloseUpdateModal = () => setShowUpdateModal(false);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const currentInvoiceId = orderId;\n  const [isCancelModalOpen, setCancelModalOpen] = useState(false);\n  const handleOpenCancelModal = () => {\n    console.log(\"HÀM MỞ MODAL ĐÃ ĐƯỢC GỌI!\");\n    setCancelModalOpen(true);\n  };\n  const handleCloseCancelModal = () => {\n    setCancelModalOpen(false);\n  };\n  const handleOpenModal = () => {\n    setIsModalOpen(true);\n  };\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n  };\n  const fetchOrderDetail = useCallback(async () => {\n    if (!orderId) {\n      setError(new Error(\"Không tìm thấy ID đơn hàng trong URL.\"));\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      var _data$phiVanChuyen, _data$tongTienBanDau, _data$tongGiaGiam, _data$tongHoaDon;\n      const response = await fetch(`http://localhost:8080/api/hoa-don/${orderId}`);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          message: `HTTP error! status: ${response.status}`\n        }));\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      const transformedData = {\n        id: data.id,\n        maHoaDon: data.maHoaDon,\n        customerName: data.tenKhachHang,\n        phoneNumber: data.sdt || \"N/A\",\n        type: mapOrderType(data.loaiHoaDon),\n        receiverName: data.tenKhachHang,\n        status: mapStatus(data.trangThai),\n        ngayTao: data.ngayTao,\n        diaChi: data.diaChi,\n        StaffName: data.tenNhanVien,\n        products: (data.danhSachChiTiet || []).map(item => ({\n          id: item.id,\n          name: item.tenSanPhamChiTiet || `Sản phẩm ${item.maSanPhamChiTiet}`,\n          price: item.gia,\n          size: \"N/A\",\n          quantity: item.soLuong,\n          imageUrl: item.linkAnh || \"/assets/img/logo.jpg\",\n          maSanPhamChiTiet: item.maSanPhamChiTiet\n        })),\n        discountCode: \"Không có\",\n        shopDiscount: data.tongGiaGiam && data.tongTienBanDau ? `${(data.tongGiaGiam * 100 / data.tongTienBanDau).toFixed(0)}%` : \"0%\",\n        shippingFee: (_data$phiVanChuyen = data.phiVanChuyen) !== null && _data$phiVanChuyen !== void 0 ? _data$phiVanChuyen : 0,\n        totalItemsPrice: (_data$tongTienBanDau = data.tongTienBanDau) !== null && _data$tongTienBanDau !== void 0 ? _data$tongTienBanDau : 0,\n        totalDiscount: (_data$tongGiaGiam = data.tongGiaGiam) !== null && _data$tongGiaGiam !== void 0 ? _data$tongGiaGiam : 0,\n        totalAmount: (_data$tongHoaDon = data.tongHoaDon) !== null && _data$tongHoaDon !== void 0 ? _data$tongHoaDon : 0,\n        payments: (data.lichSuThanhToan || []).map(p => ({\n          method: p.hinhThucThanhToan || \"Chưa xác định\",\n          amount: p.soTienThanhToan,\n          date: p.thoiGian ? new Date(p.thoiGian).toLocaleString(\"vi-VN\") : \"N/A\",\n          status: mapPaymentStatus(p.trangThaiThanhToan)\n        })),\n        trangThaiGoc: data.trangThai\n      };\n      setOrderData(transformedData);\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [orderId]);\n  console.log(\"OrderDetailPage orderData:\", orderData);\n  useEffect(() => {\n    fetchOrderDetail();\n  }, [fetchOrderDetail]);\n  const handleConfirmCancellation = async ghiChuFromDialog => {\n    setIsCancelling(true); // Bật loading\n    try {\n      const payload = {\n        ghiChu: ghiChuFromDialog,\n        nguoiThucHien: \"Admin\"\n      };\n      const response = await fetch(`http://localhost:8080/api/hoa-don/chuyen-trang-thai-huy/${orderId}`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.message || `Lỗi HTTP! Trạng thái: ${response.status}`);\n      }\n      toast.success(\"Đơn hàng đã được hủy thành công!\");\n      await fetchOrderDetail(); // Tải lại dữ liệu trang\n    } catch (err) {\n      console.error(\"Lỗi khi hủy đơn hàng:\", err);\n      toast.error(err.message || \"Có lỗi xảy ra khi hủy đơn hàng.\");\n    } finally {\n      setIsCancelling(false); // Tắt loading\n      handleCloseCancelModal(); // Đóng dialog\n    }\n  };\n  const handleConfirmStatus = async () => {\n    if ((orderData === null || orderData === void 0 ? void 0 : orderData.trangThaiGoc) === \"DANG_VAN_CHUYEN\") {\n      try {\n        // 2. Gọi API lịch sử thanh toán để lấy các giao dịch\n        const response = await fetch(`http://localhost:8080/chiTietThanhToan/lich-su-thanh-toan/${orderId}`);\n        if (!response.ok) {}\n        const historyData = await response.json();\n\n        // 3. Tính tổng số tiền đã thanh toán từ kết quả API\n        let totalPaid = 0;\n        if (historyData.code === 1000 && Array.isArray(historyData.data)) {\n          totalPaid = historyData.data.reduce((sum, payment) => sum + payment.soTienThanhToan, 0);\n        }\n\n        // 4. So sánh với tổng giá trị hóa đơn\n        if (totalPaid < orderData.totalAmount) {\n          toast.error(\"Đơn hàng chưa được thanh toán đủ. Không thể hoàn thành.\");\n          return;\n        }\n      } catch (err) {\n        toast.error(err.message || \"Không thể xác thực trạng thái thanh toán.\");\n        return;\n      }\n    }\n    const originalStatus = orderData === null || orderData === void 0 ? void 0 : orderData.trangThaiGoc;\n    setActionLoading(true);\n    setActionError(null);\n    try {\n      const payload = {\n        ghiChu: \"Chuyển trạng thái tự động\",\n        nguoiThucHien: nguoiThucHienAction\n      };\n      const response = await fetch(`http://localhost:8080/api/hoa-don/chuyen-trang-thai-tiep-theo/${orderId}`, {\n        method: \"PUT\",\n        // Xác định HTTP method\n        headers: {\n          \"Content-Type\": \"application/json\" // Báo cho server biết body là JSON\n        },\n        body: JSON.stringify(payload) // Chuyển payload thành chuỗi JSON\n      });\n      if (!response.ok) {\n        // Kiểm tra status code cho fetch\n        const errorData = await response.json().catch(() => ({\n          message: `HTTP error! status: ${response.status}`\n        }));\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\n      }\n      toast.success(\"Đã chuyển trạng thái thành công!\");\n      if (originalStatus === \"DA_XAC_NHAN\") {\n        handleOpenModal();\n      }\n      await fetchOrderDetail(); // Tải lại dữ liệu hóa đơn để cập nhật giao diện\n    } catch (err) {\n      console.error(\"Lỗi khi chuyển trạng thái tiếp theo:\", err);\n      setActionError(err.message || \"Có lỗi xảy ra khi chuyển trạng thái. Vui lòng thử lại.\");\n    } finally {\n      setActionLoading(false);\n    }\n  };\n  const handleClickCancelButton = () => {\n    if (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\") {} else {\n      setShowCancelDialog(true);\n    }\n  };\n\n  // === LOGIC DERIVED STATE ===\n  const isConfirmButtonDisabled = orderData && (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\");\n  const isCancelButtonDisabled = orderData && (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\");\n  const canUpdateInfo = orderData && (orderData.status === \"Tạo đơn hàng\" || orderData.status === \"Chờ xác nhận\" || orderData.status === \"Đã xác nhận\");\n  const initialUpdateData = orderData ? {\n    tenNguoiNhan: orderData.receiverName,\n    soDienThoai: orderData.phoneNumber,\n    diaChi: orderData.diaChi\n  } : {};\n\n  // Hàm xử lý in hóa đơn\n  // Trong OrderDetailPage/index.jsx\n  const viewPdf = async orderId => {\n    try {\n      const apiUrl = `http://localhost:8080/api/hoa-don/${orderId}/pdf`;\n      const response = await fetch(apiUrl);\n      if (!response.ok) {\n        throw new Error(\"Không thể tải file PDF!\");\n      }\n\n      // 1. Lấy dữ liệu PDF dưới dạng Blob\n      const pdfBlob = await response.blob();\n\n      // 2. Tạo một URL tạm thời cho Blob\n      const pdfUrl = URL.createObjectURL(pdfBlob);\n\n      // 3. Mở URL này trong một tab mới\n      window.open(pdfUrl);\n\n      // (Tùy chọn nhưng nên có) Thu hồi URL để giải phóng bộ nhớ sau khi tab đã mở\n      setTimeout(() => URL.revokeObjectURL(pdfUrl), 100);\n    } catch (error) {\n      console.error(\"Lỗi khi hiển thị PDF:\", error);\n      // Xử lý lỗi, ví dụ: hiển thị thông báo cho người dùng\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n      children: [/*#__PURE__*/_jsxDEV(DashboardNavbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"calc(100vh - 150px)\",\n        children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n          color: \"info\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SoftTypography, {\n          variant: \"h5\",\n          ml: 2,\n          children: \"\\u0110ang t\\u1EA3i chi ti\\u1EBFt \\u0111\\u01A1n h\\xE0ng...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n      children: [/*#__PURE__*/_jsxDEV(DashboardNavbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        p: 3,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"error\",\n          children: [error.message, \". Kh\\xF4ng th\\u1EC3 t\\u1EA3i chi ti\\u1EBFt \\u0111\\u01A1n h\\xE0ng.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this);\n  }\n  if (!orderData) {\n    return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n      children: [/*#__PURE__*/_jsxDEV(DashboardNavbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        p: 3,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"warning\",\n          children: \"Kh\\xF4ng t\\xECm th\\u1EA5y \\u0111\\u01A1n h\\xE0ng.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n    children: [/*#__PURE__*/_jsxDEV(DashboardNavbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n      py: 3,\n      children: [actionError && /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 2,\n        px: 3,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"error\",\n          children: actionError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 3,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(SoftBox, {\n            p: 3,\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h5\",\n              fontWeight: \"medium\",\n              mb: 3,\n              sx: {\n                color: \"#6ea8fe\"\n              },\n              children: [\"L\\u1ECBch s\\u1EED \\u0111\\u01A1n h\\xE0ng / \", orderData.maHoaDon]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(OrderHistory, {\n              orderId: orderData.maHoaDon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n              display: \"flex\",\n              justifyContent: \"flex-end\",\n              mt: 3,\n              gap: 1.5,\n              children: [!isConfirmButtonDisabled && /*#__PURE__*/_jsxDEV(SoftButton, {\n                variant: \"outlined\",\n                size: \"large\",\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                onClick: handleConfirmStatus,\n                disabled: actionLoading,\n                children: actionLoading ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n                  size: 20,\n                  color: \"inherit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 395,\n                  columnNumber: 23\n                }, this) : \"Xác nhận (Trạng thái tiếp theo)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 19\n              }, this), !isCancelButtonDisabled && (orderData === null || orderData === void 0 ? void 0 : orderData.type) !== \"Tại quầy\" && /*#__PURE__*/_jsxDEV(SoftButton, {\n                onClick: handleOpenCancelModal,\n                disabled: isCancelButtonDisabled || actionLoading,\n                variant: \"outlined\",\n                color: \"error\",\n                sx: {\n                  textTransform: \"none\",\n                  // Giữ lại logic style cho trạng thái disabled\n                  ...(isCancelButtonDisabled && {\n                    opacity: 0.5,\n                    cursor: \"not-allowed\"\n                  })\n                },\n                children: actionLoading && !isConfirmButtonDisabled ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n                  size: 20,\n                  color: \"inherit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 23\n                }, this) : \"Hủy đơn\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(SoftButton, {\n                variant: \"outlined\",\n                size: \"medium\",\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                onClick: setShowHistoryModal,\n                children: \"Chi ti\\u1EBFt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 424,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(SoftButton, {\n                variant: \"outlined\",\n                size: \"medium\",\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                onClick: handleOpenModal // Trigger print function\n                ,\n                disabled: !canUpdateInfo // Disable if no data to print\n                ,\n                children: \"In h\\xF3a \\u0111\\u01A1n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 3,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(SoftBox, {\n            p: 3,\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h5\",\n              fontWeight: \"medium\",\n              mb: 3,\n              sx: {\n                color: \"#6ea8fe\"\n              },\n              children: \"Th\\xF4ng tin \\u0111\\u01A1n h\\xE0ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(OrderInfo, {\n              order: orderData\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 15\n            }, this), !isCancelButtonDisabled && (orderData === null || orderData === void 0 ? void 0 : orderData.type) !== \"Tại quầy\" && /*#__PURE__*/_jsxDEV(SoftBox, {\n              display: \"flex\",\n              justifyContent: \"flex-end\",\n              mt: 3,\n              children: /*#__PURE__*/_jsxDEV(SoftButton, {\n                variant: \"outlined\",\n                size: \"large\",\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                onClick: handleOpenUpdateModal,\n                children: \"C\\u1EADp nh\\u1EADt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 3,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(SoftBox, {\n            p: 3,\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h5\",\n              fontWeight: \"medium\",\n              mb: 3,\n              sx: {\n                color: \"#6ea8fe\"\n              },\n              children: \"L\\u1ECBch s\\u1EED thanh to\\xE1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(PaymentHistory, {\n              orderId: orderData.id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 509,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 508,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 3,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(SoftBox, {\n            p: 3,\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h5\",\n              fontWeight: \"medium\",\n              mb: 3,\n              sx: {\n                color: \"#6ea8fe\"\n              },\n              children: \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 523,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ProductList, {\n              orderId: orderId,\n              orderStatus: orderData.trangThaiGoc\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 522,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 520,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n        mb: 3,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(SoftBox, {\n            p: 3,\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h5\",\n              fontWeight: \"medium\",\n              mb: 3,\n              children: \"T\\u1ED5ng ti\\u1EC1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(OrderSummary, {\n              orderId: orderData.id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 538,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 532,\n        columnNumber: 9\n      }, this), showHistoryModal && orderData && /*#__PURE__*/_jsxDEV(OrderHistoryModal, {\n        maHoaDon: orderData.maHoaDon,\n        onClose: handleCloseHistoryModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(CancelOrderDialog, {\n        isOpen: isCancelModalOpen,\n        onClose: handleCloseCancelModal,\n        onConfirmCancel: handleConfirmCancellation,\n        isLoading: isCancelling\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 11\n      }, this), showUpdateModal && orderData && /*#__PURE__*/_jsxDEV(UpdateOrderInfo, {\n        show: showUpdateModal,\n        onClose: handleCloseUpdateModal,\n        orderId: orderData.id,\n        initialData: initialUpdateData,\n        onUpdateSuccess: fetchOrderDetail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InHoaDon, {\n        isOpen: isModalOpen,\n        onClose: handleCloseModal,\n        hoaDonId: currentInvoiceId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"none\"\n        },\n        children: orderData && /*#__PURE__*/_jsxDEV(InHoaDon, {\n          ref: componentRef,\n          orderData: orderData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 571,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 355,\n    columnNumber: 5\n  }, this);\n};\n_s(OrderDetailPage, \"mbcnPsivnlFjUfGRG8nTYzNgU9Q=\", false, function () {\n  return [useParams];\n});\n_c = OrderDetailPage;\nCancelOrderDialog.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onConfirmCancel: PropTypes.func.isRequired,\n  isLoading: PropTypes.bool // Thêm dòng này\n};\nexport default OrderDetailPage;\nvar _c;\n$RefreshReg$(_c, \"OrderDetailPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useParams","DashboardLayout","DashboardNavbar","Footer","SoftBox","SoftTypography","Card","CircularProgress","Alert","SoftButton","OrderHistory","OrderInfo","PaymentHistory","ProductList","OrderSummary","OrderHistoryModal","CancelOrderDialog","UpdateOrderInfo","useReactToPrint","toast","InHoaDon","PropTypes","jsxDEV","_jsxDEV","statusMap","HOAN_THANH","CHO_XAC_NHAN","DANG_GIAO","DA_XAC_NHAN","HUY","CHO_THANH_TOAN","DA_THANH_TOAN","CHO_GIAO_HANG","DANG_VAN_CHUYEN","TAO_DON_HANG","paymentStatusMap","orderTypeMap","tai_quay","giao_hang","online","mapStatus","apiStatus","mapPaymentStatus","mapOrderType","apiType","OrderDetailPage","_s","orderId","orderData","setOrderData","loading","setLoading","error","setError","showHistoryModal","setShowHistoryModal","actionLoading","setActionLoading","actionError","setActionError","nguoiThucHienAction","showUpdateModal","setShowUpdateModal","componentRef","isCancelling","setIsCancelling","handleShowHistoryModal","handleCloseHistoryModal","handleOpenUpdateModal","handleCloseUpdateModal","isModalOpen","setIsModalOpen","currentInvoiceId","isCancelModalOpen","setCancelModalOpen","handleOpenCancelModal","console","log","handleCloseCancelModal","handleOpenModal","handleCloseModal","fetchOrderDetail","Error","_data$phiVanChuyen","_data$tongTienBanDau","_data$tongGiaGiam","_data$tongHoaDon","response","fetch","ok","errorData","json","catch","message","status","data","transformedData","id","maHoaDon","customerName","tenKhachHang","phoneNumber","sdt","type","loaiHoaDon","receiverName","trangThai","ngayTao","diaChi","StaffName","tenNhanVien","products","danhSachChiTiet","map","item","name","tenSanPhamChiTiet","maSanPhamChiTiet","price","gia","size","quantity","soLuong","imageUrl","linkAnh","discountCode","shopDiscount","tongGiaGiam","tongTienBanDau","toFixed","shippingFee","phiVanChuyen","totalItemsPrice","totalDiscount","totalAmount","tongHoaDon","payments","lichSuThanhToan","p","method","hinhThucThanhToan","amount","soTienThanhToan","date","thoiGian","Date","toLocaleString","trangThaiThanhToan","trangThaiGoc","err","handleConfirmCancellation","ghiChuFromDialog","payload","ghiChu","nguoiThucHien","headers","body","JSON","stringify","success","handleConfirmStatus","historyData","totalPaid","code","Array","isArray","reduce","sum","payment","originalStatus","handleClickCancelButton","setShowCancelDialog","isConfirmButtonDisabled","isCancelButtonDisabled","canUpdateInfo","initialUpdateData","tenNguoiNhan","soDienThoai","viewPdf","apiUrl","pdfBlob","blob","pdfUrl","URL","createObjectURL","window","open","setTimeout","revokeObjectURL","children","fileName","_jsxFileName","lineNumber","columnNumber","display","justifyContent","alignItems","height","color","variant","ml","severity","py","mb","px","fontWeight","sx","mt","gap","borderRadius","textTransform","borderColor","boxShadow","background","onClick","disabled","opacity","cursor","order","orderStatus","onClose","isOpen","onConfirmCancel","isLoading","show","initialData","onUpdateSuccess","hoaDonId","style","ref","_c","propTypes","bool","isRequired","func","$RefreshReg$"],"sources":["D:/fashion-shirt-shop/DATN/src/main/resources/templates/fashionshop-ui/src/layouts/admin/HoaDon/pages/OrderDetailPage.jsx"],"sourcesContent":["// src/layouts/HoaDon/OrderDetailPage/index.jsx\n\nimport React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\n// === IMPORT LAYOUT COMPONENTS ===\nimport DashboardLayout from \"../../../../examples/LayoutContainers/DashboardLayout\";\nimport DashboardNavbar from \"../../../../examples/Navbars/DashboardNavbar\";\nimport Footer from \"../../../../examples/Footer\";\n\n// === IMPORT CÁC COMPONENT TỪ @mui/material VÀ SOFT UI ===\nimport SoftBox from \"../../../../components/SoftBox\";\nimport SoftTypography from \"../../../../components/SoftTypography\";\nimport Card from \"@mui/material/Card\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Alert from \"@mui/material/Alert\";\nimport SoftButton from \"../../../../components/SoftButton\";\n\n\nimport OrderHistory from \"../OrderDetail/OrderHistory\";\nimport OrderInfo from \"../OrderDetail/OrderInfo\";\nimport PaymentHistory from \"../OrderDetail/PaymentHistory\";\nimport ProductList from \"../OrderDetail/ProductList\";\nimport OrderSummary from \"../OrderDetail/OrderSummary\";\nimport OrderHistoryModal from \"../OrderHistoryModal/OrderHistoryModal\";\nimport CancelOrderDialog from \"../OrderDetail/CancelOrderDialog/CancelOrderDialog\";\nimport UpdateOrderInfo from \"../UpdateOrderInfo/UpdateOrderInfo\";\nimport { useReactToPrint } from \"react-to-print\";\n\nimport { toast } from \"react-toastify\";\nimport InHoaDon from \"../InHoaDon/InHoaDon.jsx\";\nimport PropTypes from \"prop-types\";\n\n\nconst statusMap = {\n  HOAN_THANH: \"Hoàn thành\",\n  CHO_XAC_NHAN: \"Chờ xác nhận\",\n  DANG_GIAO: \"Đang giao\",\n  DA_XAC_NHAN: \"Đã xác nhận\",\n  HUY: \"Đã hủy\",\n  CHO_THANH_TOAN: \"Chờ thanh toán\",\n  DA_THANH_TOAN: \"Đã thanh toán\",\n  CHO_GIAO_HANG: \"Chờ giao hàng\",\n  DANG_VAN_CHUYEN: \"Đang vận chuyển\",\n  TAO_DON_HANG: \"Tạo đơn hàng\",\n};\nconst paymentStatusMap = { HOAN_THANH: \"Đã thanh toán\", CHO_XAC_NHAN: \"Chờ thanh toán\" };\nconst orderTypeMap = { tai_quay: \"Tại quầy\", giao_hang: \"Giao hàng\", online: \"Trực tuyến\" };\n\nconst mapStatus = (apiStatus) => statusMap[apiStatus] || apiStatus;\nconst mapPaymentStatus = (apiStatus) => paymentStatusMap[apiStatus] || apiStatus;\nconst mapOrderType = (apiType) => orderTypeMap[apiType] || apiType;\n\nconst OrderDetailPage = () => {\n  // === HOOKS VÀ STATE ===\n  const { orderId } = useParams();\n  const [orderData, setOrderData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\n  const [actionLoading, setActionLoading] = useState(false);\n  const [actionError, setActionError] = useState(null);\n  const [nguoiThucHienAction] = useState(\"Admin\");\n\n  const [showUpdateModal, setShowUpdateModal] = useState(false);\n  const componentRef = useRef();\n  const [isCancelling, setIsCancelling] = useState(false);\n  // === HÀM XỬ LÝ ===\n  const handleShowHistoryModal = () => setShowHistoryModal(true);\n  const handleCloseHistoryModal = () => setShowHistoryModal(false);\n  const handleOpenUpdateModal = () => setShowUpdateModal(true);\n  const handleCloseUpdateModal = () => setShowUpdateModal(false);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const currentInvoiceId = orderId;\n  const [isCancelModalOpen, setCancelModalOpen] = useState(false);\n\n  const handleOpenCancelModal = () => {\n    console.log(\"HÀM MỞ MODAL ĐÃ ĐƯỢC GỌI!\");\n    setCancelModalOpen(true);\n  };\n\n  const handleCloseCancelModal = () => {\n    setCancelModalOpen(false);\n  };\n  const handleOpenModal = () => {\n    setIsModalOpen(true);\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n  };\n  const fetchOrderDetail = useCallback(async () => {\n    if (!orderId) {\n      setError(new Error(\"Không tìm thấy ID đơn hàng trong URL.\"));\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(`http://localhost:8080/api/hoa-don/${orderId}`);\n      if (!response.ok) {\n        const errorData = await response\n          .json()\n          .catch(() => ({ message: `HTTP error! status: ${response.status}` }));\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      const transformedData = {\n        id: data.id,\n        maHoaDon: data.maHoaDon,\n        customerName: data.tenKhachHang,\n        phoneNumber: data.sdt || \"N/A\",\n        type: mapOrderType(data.loaiHoaDon),\n        receiverName: data.tenKhachHang,\n        status: mapStatus(data.trangThai),\n        ngayTao: data.ngayTao,\n        diaChi: data.diaChi,\n        StaffName: data.tenNhanVien,\n        products: (data.danhSachChiTiet || []).map((item) => ({\n          id: item.id,\n          name: item.tenSanPhamChiTiet || `Sản phẩm ${item.maSanPhamChiTiet}`,\n          price: item.gia,\n          size: \"N/A\",\n          quantity: item.soLuong,\n          imageUrl: item.linkAnh || \"/assets/img/logo.jpg\",\n          maSanPhamChiTiet: item.maSanPhamChiTiet,\n        })),\n        discountCode: \"Không có\",\n        shopDiscount:\n          data.tongGiaGiam && data.tongTienBanDau\n            ? `${((data.tongGiaGiam * 100) / data.tongTienBanDau).toFixed(0)}%`\n            : \"0%\",\n        shippingFee: data.phiVanChuyen ?? 0,\n        totalItemsPrice: data.tongTienBanDau ?? 0,\n        totalDiscount: data.tongGiaGiam ?? 0,\n        totalAmount: data.tongHoaDon ?? 0,\n        payments: (data.lichSuThanhToan || []).map((p) => ({\n          method: p.hinhThucThanhToan || \"Chưa xác định\",\n          amount: p.soTienThanhToan,\n          date: p.thoiGian ? new Date(p.thoiGian).toLocaleString(\"vi-VN\") : \"N/A\",\n          status: mapPaymentStatus(p.trangThaiThanhToan),\n        })),\n        trangThaiGoc: data.trangThai,\n      };\n      setOrderData(transformedData);\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [orderId]);\n  console.log(\"OrderDetailPage orderData:\", orderData);\n  useEffect(() => {\n    fetchOrderDetail();\n  }, [fetchOrderDetail]);\n  const handleConfirmCancellation = async (ghiChuFromDialog) => {\n    setIsCancelling(true); // Bật loading\n    try {\n      const payload = {\n        ghiChu: ghiChuFromDialog,\n        nguoiThucHien: \"Admin\",\n      };\n      const response = await fetch(\n        `http://localhost:8080/api/hoa-don/chuyen-trang-thai-huy/${orderId}`,\n        {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(payload),\n        }\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.message || `Lỗi HTTP! Trạng thái: ${response.status}`);\n      }\n\n      toast.success(\"Đơn hàng đã được hủy thành công!\");\n      await fetchOrderDetail(); // Tải lại dữ liệu trang\n    } catch (err) {\n      console.error(\"Lỗi khi hủy đơn hàng:\", err);\n      toast.error(err.message || \"Có lỗi xảy ra khi hủy đơn hàng.\");\n    } finally {\n      setIsCancelling(false); // Tắt loading\n      handleCloseCancelModal(); // Đóng dialog\n    }\n  };\n  const handleConfirmStatus = async () => {\n  if (orderData?.trangThaiGoc === \"DANG_VAN_CHUYEN\") {\n      try {\n        // 2. Gọi API lịch sử thanh toán để lấy các giao dịch\n        const response = await fetch(\n          `http://localhost:8080/chiTietThanhToan/lich-su-thanh-toan/${orderId}`\n        );\n\n        if (!response.ok) {\n         \n        }\n\n        const historyData = await response.json();\n\n        // 3. Tính tổng số tiền đã thanh toán từ kết quả API\n        let totalPaid = 0;\n        if (historyData.code === 1000 && Array.isArray(historyData.data)) {\n          totalPaid = historyData.data.reduce(\n            (sum, payment) => sum + payment.soTienThanhToan,\n            0\n          );\n        }\n\n        // 4. So sánh với tổng giá trị hóa đơn\n        if (totalPaid < orderData.totalAmount) {\n          toast.error(\"Đơn hàng chưa được thanh toán đủ. Không thể hoàn thành.\");\n          return;\n        }\n      } catch (err) {\n        toast.error(err.message || \"Không thể xác thực trạng thái thanh toán.\");\n        return;\n      }\n    }\n      const originalStatus = orderData?.trangThaiGoc;\n    setActionLoading(true);\n    setActionError(null);\n    try {\n      const payload = {\n        ghiChu: \"Chuyển trạng thái tự động\",\n        nguoiThucHien: nguoiThucHienAction,\n      };\n      const response = await fetch(\n        `http://localhost:8080/api/hoa-don/chuyen-trang-thai-tiep-theo/${orderId}`,\n        {\n          method: \"PUT\", // Xác định HTTP method\n          headers: {\n            \"Content-Type\": \"application/json\", // Báo cho server biết body là JSON\n          },\n          body: JSON.stringify(payload), // Chuyển payload thành chuỗi JSON\n        }\n      );\n      if (!response.ok) {\n        // Kiểm tra status code cho fetch\n        const errorData = await response\n          .json()\n          .catch(() => ({ message: `HTTP error! status: ${response.status}` }));\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\n      }\n      toast.success(\"Đã chuyển trạng thái thành công!\");\n      \n    if (originalStatus === \"DA_XAC_NHAN\") {\n      handleOpenModal(); \n    }\n      await fetchOrderDetail(); // Tải lại dữ liệu hóa đơn để cập nhật giao diện\n    } catch (err) {\n      console.error(\"Lỗi khi chuyển trạng thái tiếp theo:\", err);\n      setActionError(err.message || \"Có lỗi xảy ra khi chuyển trạng thái. Vui lòng thử lại.\");\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleClickCancelButton = () => {\n    if (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\") {\n    } else {\n      setShowCancelDialog(true);\n    }\n  };\n\n  // === LOGIC DERIVED STATE ===\n  const isConfirmButtonDisabled =\n    orderData && (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\");\n  const isCancelButtonDisabled =\n    orderData && (orderData.status === \"Hoàn thành\" || orderData.status === \"Đã hủy\");\n  const canUpdateInfo =\n    orderData && (orderData.status === \"Tạo đơn hàng\" || orderData.status === \"Chờ xác nhận\"|| orderData.status === \"Đã xác nhận\");\n\n  const initialUpdateData = orderData\n    ? {\n        tenNguoiNhan: orderData.receiverName,\n        soDienThoai: orderData.phoneNumber,\n        diaChi: orderData.diaChi,\n      }\n    : {};\n\n  // Hàm xử lý in hóa đơn\n  // Trong OrderDetailPage/index.jsx\n  const viewPdf = async (orderId) => {\n    try {\n      const apiUrl = `http://localhost:8080/api/hoa-don/${orderId}/pdf`;\n      const response = await fetch(apiUrl);\n\n      if (!response.ok) {\n        throw new Error(\"Không thể tải file PDF!\");\n      }\n\n      // 1. Lấy dữ liệu PDF dưới dạng Blob\n      const pdfBlob = await response.blob();\n\n      // 2. Tạo một URL tạm thời cho Blob\n      const pdfUrl = URL.createObjectURL(pdfBlob);\n\n      // 3. Mở URL này trong một tab mới\n      window.open(pdfUrl);\n\n      // (Tùy chọn nhưng nên có) Thu hồi URL để giải phóng bộ nhớ sau khi tab đã mở\n      setTimeout(() => URL.revokeObjectURL(pdfUrl), 100);\n    } catch (error) {\n      console.error(\"Lỗi khi hiển thị PDF:\", error);\n      // Xử lý lỗi, ví dụ: hiển thị thông báo cho người dùng\n    }\n  };\n  if (loading) {\n    return (\n      <DashboardLayout>\n        <DashboardNavbar />\n        <SoftBox\n          display=\"flex\"\n          justifyContent=\"center\"\n          alignItems=\"center\"\n          height=\"calc(100vh - 150px)\"\n        >\n          <CircularProgress color=\"info\" />\n          <SoftTypography variant=\"h5\" ml={2}>\n            Đang tải chi tiết đơn hàng...\n          </SoftTypography>\n        </SoftBox>\n        <Footer />\n      </DashboardLayout>\n    );\n  }\n\n  if (error) {\n    return (\n      <DashboardLayout>\n        <DashboardNavbar />\n        <SoftBox p={3}>\n          <Alert severity=\"error\">{error.message}. Không thể tải chi tiết đơn hàng.</Alert>\n        </SoftBox>\n        <Footer />\n      </DashboardLayout>\n    );\n  }\n\n  if (!orderData) {\n    return (\n      <DashboardLayout>\n        <DashboardNavbar />\n        <SoftBox p={3}>\n          <Alert severity=\"warning\">Không tìm thấy đơn hàng.</Alert>\n        </SoftBox>\n        <Footer />\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout>\n      <DashboardNavbar />\n      <SoftBox py={3}>\n        {actionError && (\n          <SoftBox mb={2} px={3}>\n            <Alert severity=\"error\">{actionError}</Alert>\n          </SoftBox>\n        )}\n\n        {/* Phần Lịch sử đơn hàng và các nút hành động */}\n        <SoftBox mb={3}>\n          <Card>\n            <SoftBox p={3}>\n              <SoftTypography variant=\"h5\" fontWeight=\"medium\" mb={3} sx={{ color: \"#6ea8fe\" }}>\n                Lịch sử đơn hàng / {orderData.maHoaDon}\n              </SoftTypography>\n\n              <OrderHistory orderId={orderData.maHoaDon} />\n              <SoftBox display=\"flex\" justifyContent=\"flex-end\" mt={3} gap={1.5}>\n                {!isConfirmButtonDisabled && (\n                  <SoftButton\n                    variant=\"outlined\"\n                    size=\"large\"\n                    sx={{\n                      borderRadius: 2,\n                      textTransform: \"none\",\n                      fontWeight: 400,\n                      color: \"#49a3f1\",\n                      borderColor: \"#49a3f1\",\n                      boxShadow: \"none\",\n                      \"&:hover\": {\n                        borderColor: \"#1769aa\",\n                        background: \"#f0f6fd\",\n                        color: \"#1769aa\",\n                      },\n                    }}\n                    onClick={handleConfirmStatus}\n                    disabled={actionLoading}\n                  >\n                    {actionLoading ? (\n                      <CircularProgress size={20} color=\"inherit\" />\n                    ) : (\n                      \"Xác nhận (Trạng thái tiếp theo)\"\n                    )}\n                  </SoftButton>\n                )}\n                {!isCancelButtonDisabled && orderData?.type !== \"Tại quầy\" && (\n                  <SoftButton\n                   \n                    onClick={handleOpenCancelModal}\n                    disabled={isCancelButtonDisabled || actionLoading}\n                     variant=\"outlined\"\n                    color=\"error\"\n                    sx={{\n                      textTransform: \"none\",\n                      // Giữ lại logic style cho trạng thái disabled\n                      ...(isCancelButtonDisabled && {\n                        opacity: 0.5,\n                        cursor: \"not-allowed\",\n                      }),\n                    }}\n                  >\n                    {actionLoading && !isConfirmButtonDisabled ? (\n                      <CircularProgress size={20} color=\"inherit\" />\n                    ) : (\n                      \"Hủy đơn\"\n                    )}\n                  </SoftButton>\n                )}\n                <SoftButton\n                  variant=\"outlined\"\n                  size=\"medium\"\n                  sx={{\n                    borderRadius: 2,\n                    textTransform: \"none\",\n                    fontWeight: 400,\n                    color: \"#49a3f1\",\n                    borderColor: \"#49a3f1\",\n                    boxShadow: \"none\",\n                    \"&:hover\": {\n                      borderColor: \"#1769aa\",\n                      background: \"#f0f6fd\",\n                      color: \"#1769aa\",\n                    },\n                  }}\n                  onClick={setShowHistoryModal}\n                >\n                  Chi tiết\n                </SoftButton>\n                <SoftButton\n                  variant=\"outlined\"\n                  size=\"medium\"\n                  sx={{\n                    borderRadius: 2,\n                    textTransform: \"none\",\n                    fontWeight: 400,\n                    color: \"#49a3f1\",\n                    borderColor: \"#49a3f1\",\n                    boxShadow: \"none\",\n                    \"&:hover\": {\n                      borderColor: \"#1769aa\",\n                      background: \"#f0f6fd\",\n                      color: \"#1769aa\",\n                    },\n                  }}\n                  onClick={handleOpenModal} // Trigger print function\n                  disabled={!canUpdateInfo} // Disable if no data to print\n                >\n                  In hóa đơn\n                </SoftButton>\n              </SoftBox>\n            </SoftBox>\n          </Card>\n        </SoftBox>\n\n        {/* Thông tin đơn hàng và nút cập nhật */}\n        <SoftBox mb={3}>\n          <Card>\n            <SoftBox p={3}>\n              <SoftTypography variant=\"h5\" fontWeight=\"medium\" mb={3} sx={{ color: \"#6ea8fe\" }}>\n                Thông tin đơn hàng\n              </SoftTypography>\n\n              <OrderInfo order={orderData} />\n              {!isCancelButtonDisabled && orderData?.type !== \"Tại quầy\" && (\n                <SoftBox display=\"flex\" justifyContent=\"flex-end\" mt={3}>\n                  <SoftButton\n                    variant=\"outlined\"\n                    size=\"large\"\n                    sx={{\n                      borderRadius: 2,\n                      textTransform: \"none\",\n                      fontWeight: 400,\n                      color: \"#49a3f1\",\n                      borderColor: \"#49a3f1\",\n                      boxShadow: \"none\",\n                      \"&:hover\": {\n                        borderColor: \"#1769aa\",\n                        background: \"#f0f6fd\",\n                        color: \"#1769aa\",\n                      },\n                    }}\n                    onClick={handleOpenUpdateModal}\n                  >\n                    Cập nhật\n                  </SoftButton>\n                </SoftBox>\n              )}\n            </SoftBox>\n          </Card>\n        </SoftBox>\n\n        {/* Lịch sử thanh toán */}\n        <SoftBox mb={3}>\n          <Card>\n            <SoftBox p={3}>\n              <SoftTypography variant=\"h5\" fontWeight=\"medium\" mb={3} sx={{ color: \"#6ea8fe\" }}>\n                Lịch sử thanh toán\n              </SoftTypography>\n              <PaymentHistory orderId={orderData.id} />\n            </SoftBox>\n          </Card>\n        </SoftBox>\n\n        {/* Danh sách sản phẩm */}\n        <SoftBox mb={3}>\n          <Card>\n            <SoftBox p={3}>\n              <SoftTypography variant=\"h5\" fontWeight=\"medium\" mb={3} sx={{ color: \"#6ea8fe\" }}>\n                Danh sách sản phẩm\n              </SoftTypography>\n              <ProductList orderId={orderId} orderStatus={orderData.trangThaiGoc} />\n            </SoftBox>\n          </Card>\n        </SoftBox>\n\n        {/* Tổng tiền */}\n        <SoftBox mb={3}>\n          <Card>\n            <SoftBox p={3}>\n              <SoftTypography variant=\"h5\" fontWeight=\"medium\" mb={3}>\n                Tổng tiền\n              </SoftTypography>\n              <OrderSummary orderId={orderData.id} />\n            </SoftBox>\n          </Card>\n        </SoftBox>\n\n        {/* Modals và Dialogs */}\n        {showHistoryModal && orderData && (\n          <OrderHistoryModal maHoaDon={orderData.maHoaDon} onClose={handleCloseHistoryModal} />\n        )}\n      \n          <CancelOrderDialog\n            isOpen={isCancelModalOpen}\n            onClose={handleCloseCancelModal}\n            onConfirmCancel={handleConfirmCancellation}\n            isLoading={isCancelling}\n          />\n        \n        {showUpdateModal && orderData && (\n          <UpdateOrderInfo\n            show={showUpdateModal}\n            onClose={handleCloseUpdateModal}\n            orderId={orderData.id}\n            initialData={initialUpdateData}\n            onUpdateSuccess={fetchOrderDetail}\n          />\n        )}\n\n        <InHoaDon isOpen={isModalOpen} onClose={handleCloseModal} hoaDonId={currentInvoiceId} />\n\n        <div style={{ display: \"none\" }}>\n          {orderData && <InHoaDon ref={componentRef} orderData={orderData} />}\n        </div>\n      </SoftBox>\n      <Footer />\n    </DashboardLayout>\n  );\n};\nCancelOrderDialog.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onConfirmCancel: PropTypes.func.isRequired,\n  isLoading: PropTypes.bool, // Thêm dòng này\n};\nexport default OrderDetailPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}