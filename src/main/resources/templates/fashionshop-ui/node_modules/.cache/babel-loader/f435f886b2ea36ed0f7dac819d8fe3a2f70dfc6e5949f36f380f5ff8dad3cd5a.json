{"ast":null,"code":"var _jsxFileName = \"D:\\\\fashion-shirt-shop\\\\DATN\\\\src\\\\main\\\\resources\\\\templates\\\\fashionshop-ui\\\\src\\\\layouts\\\\admin\\\\BanHangTaiQuay\\\\component\\\\SalesCounter.jsx\",\n  _s = $RefreshSig$();\n// src/layouts/sales/components/SalesCounter.jsx\n\nimport React, { useState, useMemo, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Box, Typography, Button, Tabs, Tab, IconButton, styled, Divider, TextField, Avatar, Checkbox, Badge } from \"@mui/material\";\nimport AddIcon from \"@mui/icons-material/Add\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport ShoppingCartIcon from \"@mui/icons-material/ShoppingCart\";\nimport QrCodeScannerIcon from \"@mui/icons-material/QrCodeScanner\";\nimport PersonSearchIcon from \"@mui/icons-material/PersonSearch\";\nimport PaidIcon from \"@mui/icons-material/Paid\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\nimport RemoveIcon from \"@mui/icons-material/Remove\";\n\n// Import các component chung\nimport SoftBox from \"../../../../components/SoftBox\";\nimport Card from \"@mui/material/Card\";\nimport SoftTypography from \"../../../../components/SoftTypography\";\n\n// Import modal (điều chỉnh đường dẫn nếu cần)\nimport ProductSelectionModal from \"./ProductSelectionModal\";\nimport PropTypes from \"prop-types\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst formatCurrency = amount => {\n  if (typeof amount !== \"number\" || isNaN(amount)) {\n    return \"N/A\";\n  }\n  return new Intl.NumberFormat(\"vi-VN\", {\n    style: \"currency\",\n    currency: \"VND\"\n  }).format(amount);\n};\nconst CustomTab = styled(Tab)(({\n  theme\n}) => ({\n  flexDirection: \"row\",\n  textTransform: \"none\",\n  width: \"300px\",\n  flexGrow: 0,\n  \"&:hover\": {\n    backgroundColor: \"rgba(73, 163, 241, 0.1)\"\n  },\n  \"& .MuiTab-wrapper\": {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    width: \"100%\"\n  },\n  \"&.Mui-selected\": {\n    color: \"#ffff !important\",\n    backgroundColor: \"#49a3f1 !important\"\n  }\n}));\n_c = CustomTab;\nconst MAX_ORDERS = 10;\nfunction SalesCounter({\n  onTotalChange,\n  onInvoiceIdChange,\n  onProductsChange,\n  completedOrderId\n}) {\n  _s();\n  useEffect(() => {\n    // Nếu có tín hiệu (completedOrderId có giá trị và khác null)\n    if (completedOrderId) {\n      // Tìm order trong state `orders` tương ứng với ID hóa đơn đã hoàn thành từ backend\n      const orderToClose = orders.find(o => o.idHoaDonBackend === completedOrderId);\n\n      // Nếu tìm thấy order, gọi hàm đóng tab với tùy chọn KHÔNG hoàn trả hàng\n      if (orderToClose) {\n        handleCloseOrderTab(orderToClose.id, {\n          returnStock: false\n        }); // <-- THAY ĐỔI Ở ĐÂY\n      }\n    }\n    // useEffect này sẽ chạy mỗi khi `completedOrderId` thay đổi\n  }, [completedOrderId]);\n  const [orders, setOrders] = useState(() => {\n    try {\n      const savedOrders = localStorage.getItem(\"salesOrders\");\n      return savedOrders ? JSON.parse(savedOrders) : [];\n    } catch (error) {\n      console.error(\"Lỗi khi đọc orders từ sessionStorage:\", error);\n      return [];\n    }\n  });\n  const [selectedTab, setSelectedTab] = useState(orders.length > 0 ? orders[0].id : null);\n  const [isProductModalOpen, setIsProductModalOpen] = useState(false);\n  const [selectedCustomer, setSelectedCustomer] = useState({\n    idKhachHang: 101,\n    sdt: \"012345673\",\n    ten: \"Khách lẻ\"\n  });\n  const [notes, setNotes] = useState(\"Khách thanh toán tiền mặt\");\n  const currentOrder = useMemo(() => orders.find(o => o.id === selectedTab), [orders, selectedTab]);\n  const totalAmount = useMemo(() => {\n    if (!currentOrder) return 0;\n    return currentOrder.products.filter(product => product.isSelected).reduce((total, product) => {\n      const finalPrice = product.giaTienSauKhiGiam > 0 ? product.giaTienSauKhiGiam : product.gia;\n      return total + finalPrice * product.quantity;\n    }, 0);\n  }, [currentOrder]);\n  // <<< THÊM useEffect ĐỂ GỬI totalAmount LÊN COMPONENT CHA\n  useEffect(() => {\n    // Mỗi khi totalAmount thay đổi, gọi hàm callback đã được truyền xuống\n    if (onTotalChange) {\n      onTotalChange(totalAmount);\n    }\n  }, [totalAmount, onTotalChange]);\n  useEffect(() => {\n    if (orders.length === 0) {\n      handleCreateOrder();\n    }\n  }, []);\n  useEffect(() => {\n    // Lấy ra id hóa đơn từ backend của order đang được chọn\n    const currentInvoiceId = currentOrder === null || currentOrder === void 0 ? void 0 : currentOrder.idHoaDonBackend;\n\n    // Nếu có hàm callback thì gọi nó với ID mới\n    if (onInvoiceIdChange) {\n      onInvoiceIdChange(currentInvoiceId);\n    }\n  }, [currentOrder, onInvoiceIdChange]);\n  const handleCreateOrder = async () => {\n    if (orders.length >= MAX_ORDERS) {\n      alert(`Chỉ có thể tạo tối đa ${MAX_ORDERS} đơn hàng.`);\n      return;\n    }\n    try {\n      const response = await axios.post(\"http://localhost:8080/api/hoa-don/tao-hoa-don-cho\", {\n        loaiHoaDon: \"Tại quầy\"\n      });\n      const {\n        id: idHoaDonBackend,\n        maHoaDon: maHoaDon\n      } = response.data.data;\n      const nextId = (orders.length > 0 ? Math.max(...orders.map(o => parseInt(o.id))) : 0) + 1;\n      const newOrder = {\n        id: String(nextId),\n        idHoaDonBackend: idHoaDonBackend,\n        name: maHoaDon || `Đơn hàng ${nextId}`,\n        products: []\n      };\n      console.log(idHoaDonBackend);\n      setOrders(prev => [...prev, newOrder]);\n      setSelectedTab(newOrder.id);\n    } catch (error) {\n      console.error(\"Lỗi khi tạo hóa đơn chờ:\", error);\n      alert(\"Lỗi khi tạo hóa đơn chờ. Vui lòng xem console.\");\n    }\n  };\n  const handleUpdateOrder = async () => {\n    if (!currentOrder || !currentOrder.idHoaDonBackend) {\n      alert(\"Vui lòng chọn một đơn hàng hợp lệ để cập nhật.\");\n      return;\n    }\n    const danhSachCapNhat = currentOrder.products.map(p => ({\n      id: p.idChiTietSanPham,\n      soLuong: p.quantity\n    }));\n    try {\n      await axios.post(`http://localhost:8080/api/hoa-don/cap-nhat-danh-sach-san-pham/${currentOrder.idHoaDonBackend}`, danhSachCapNhat);\n      alert(\"Cập nhật đơn hàng thành công!\");\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Lỗi khi cập nhật đơn hàng:\", error);\n      alert(`Lỗi khi cập nhật đơn hàng: ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"Lỗi không xác định.\"}`);\n    }\n  };\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"salesOrders\", JSON.stringify(orders));\n      if (selectedTab) {\n        localStorage.setItem(\"selectedSalesTab\", selectedTab);\n      } else {\n        localStorage.removeItem(\"selectedSalesTab\");\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi lưu dữ liệu vào sessionStorage:\", error);\n    }\n  }, [orders, selectedTab]);\n  useEffect(() => {\n    if (onProductsChange) {\n      onProductsChange((currentOrder === null || currentOrder === void 0 ? void 0 : currentOrder.products) || []);\n    }\n  }, [currentOrder, onProductsChange]);\n  const handleProductSelected = productToAdd => {\n    console.log(\"productToAdd:\", productToAdd);\n    const sanitizedProduct = {\n      ...productToAdd,\n      uniqueId: `${productToAdd.idChiTietSanPham}-${Date.now()}`,\n      // Luôn tạo uniqueId\n      gia: parseFloat(productToAdd.gia) || 0,\n      giaTienSauKhiGiam: productToAdd.giaTienSauKhiGiam ? parseFloat(productToAdd.giaTienSauKhiGiam) : null,\n      quantity: parseInt(productToAdd.quantity, 10) || 1,\n      isSelected: true\n    };\n    setOrders(prevOrders => prevOrders.map(order => {\n      if (order.id === selectedTab) {\n        // Tìm sản phẩm đã có trong giỏ hàng\n        const existingProduct = [...order.products] // Sao chép mảng để không thay đổi mảng gốc\n        .reverse() // Đảo ngược mảng\n        .find(p => p.idChiTietSanPham === sanitizedProduct.idChiTietSanPham && !p.isPriceLocked);\n        let updatedProducts;\n        if (!existingProduct) {\n          // TRƯỜNG HỢP 1: Sản phẩm chưa từng có trong giỏ -> Thêm mới bình thường\n          updatedProducts = [...order.products, sanitizedProduct];\n        } else {\n          const existingPrice = existingProduct.giaTienSauKhiGiam > 0 ? existingProduct.giaTienSauKhiGiam : existingProduct.gia;\n          const newPrice = sanitizedProduct.giaTienSauKhiGiam > 0 ? sanitizedProduct.giaTienSauKhiGiam : sanitizedProduct.gia;\n          const campaignsAreSame = existingProduct.idDotGiamGia === sanitizedProduct.idDotGiamGia;\n          if (existingPrice === newPrice && campaignsAreSame) {\n            // GIÁ KHÔNG ĐỔI -> Tăng số lượng của sản phẩm đã có\n            updatedProducts = order.products.map(p => p.idChiTietSanPham === sanitizedProduct.idChiTietSanPham ? {\n              ...p,\n              quantity: p.quantity + sanitizedProduct.quantity\n            } : p);\n          } else {\n            // GIÁ THAY ĐỔI -> Thêm như một dòng mới và lưu lại giá cũ để hiển thị\n            const newProductWithPriceChange = {\n              ...sanitizedProduct,\n              giaTruocKhiDoi: existingPrice // <-- Thêm thuộc tính mới\n            };\n            const productsWithLockedOld = order.products.map(p => p.uniqueId === existingProduct.uniqueId ? {\n              ...p,\n              isPriceLocked: true\n            } // <-- ĐÁNH DẤU SẢN PHẨM CŨ\n            : p);\n            updatedProducts = [...productsWithLockedOld, newProductWithPriceChange];\n          }\n        }\n        return {\n          ...order,\n          products: updatedProducts\n        };\n      }\n      return order;\n    }));\n    setIsProductModalOpen(false);\n  };\n\n  // src/layouts/sales/components/SalesCounter.jsx\n\n  const handleUpdateQuantity = async (productId, newQuantity) => {\n    // Nếu số lượng mới bằng 0 hoặc ít hơn, hãy xử lý việc xóa sản phẩm.\n    // Bạn cũng nên đảm bảo `handleRemoveProduct` gọi API để hoàn trả toàn bộ số lượng về kho.\n    if (newQuantity <= 0) {\n      handleRemoveProduct(productId);\n      return;\n    }\n\n    // Tìm sản phẩm hiện tại trong state để lấy số lượng cũ\n    const currentOrder = orders.find(o => o.id === selectedTab);\n    if (!currentOrder) return;\n    const productToUpdate = currentOrder.products.find(p => p.uniqueId === productId);\n    if (!productToUpdate) return;\n    const oldQuantity = productToUpdate.quantity;\n    const quantityChange = newQuantity - oldQuantity; // Tính toán sự thay đổi\n\n    // Nếu không có gì thay đổi thì không làm gì cả\n    if (quantityChange === 0) return;\n\n    // Xác định xem nên tăng hay giảm số lượng trong kho\n    const isIncreasingInCart = quantityChange > 0; // Số lượng trong giỏ hàng đang tăng lên?\n\n    // Dựa vào API bạn cung cấp, chúng ta sẽ có 2 endpoint\n    const endpoint = isIncreasingInCart ? `/giam-so-luong-san-pham/${productToUpdate.idChiTietSanPham}` // Giảm tồn kho\n    : `/tang-so-luong-san-pham/${productToUpdate.idChiTietSanPham}`; // Tăng (hoàn trả) tồn kho\n\n    try {\n      // BƯỚC 1: GỌI API\n      // Gửi yêu cầu PUT với `soLuong` là giá trị thay đổi (luôn là số dương)\n      await axios.put(`http://localhost:8080/api/hoa-don${endpoint}`, null, {\n        // Truyền null cho body nếu không cần\n        params: {\n          soLuong: Math.abs(quantityChange)\n        }\n      });\n\n      // BƯỚC 2: NẾU API THÀNH CÔNG, CẬP NHẬT GIAO DIỆN\n      setOrders(prevOrders => prevOrders.map(order => order.id === selectedTab ? {\n        ...order,\n        products: order.products.map(p => p.uniqueId === productId ? {\n          ...p,\n          quantity: newQuantity\n        } : p)\n      } : order));\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      // BƯỚC 3: XỬ LÝ LỖI TỪ API\n      console.error(\"Lỗi khi cập nhật số lượng sản phẩm:\", error);\n      // Thông báo cho người dùng, ví dụ: \"Số lượng tồn kho không đủ\"\n      alert(`Lỗi: ${((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || \"Không thể cập nhật số lượng.\"}`);\n    }\n  };\n  const handleRemoveProduct = async productId => {\n    // BƯỚC 1: TÌM SẢN PHẨM SẮP BỊ XÓA TRONG STATE HIỆN TẠI\n    const currentOrder = orders.find(o => o.id === selectedTab);\n    if (!currentOrder) return; // Không tìm thấy đơn hàng hiện tại\n\n    const productToRemove = currentOrder.products.find(p => p.uniqueId === productId);\n    if (!productToRemove) return;\n    try {\n      await axios.put(`http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${productToRemove.idChiTietSanPham}`, null, {\n        params: {\n          soLuong: productToRemove.quantity\n        }\n      });\n      setOrders(prevOrders => prevOrders.map(order => order.id === selectedTab ? {\n        ...order,\n        products: order.products.filter(p => p.uniqueId !== productId)\n      } : order));\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      console.error(\"Lỗi khi hoàn trả sản phẩm về kho:\", error);\n      alert(`Lỗi: ${((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || \"Không thể xóa sản phẩm.\"}`);\n    }\n  };\n  const handleToggleProductSelection = productId => {\n    setOrders(prevOrders => prevOrders.map(order => order.id === selectedTab ? {\n      ...order,\n      products: order.products.map(p => p.uniqueId === productId ? {\n        ...p,\n        isSelected: !p.isSelected\n      } : p)\n    } : order));\n  };\n  const handleToggleAllProducts = shouldSelectAll => {\n    setOrders(prevOrders => prevOrders.map(order => order.id === selectedTab ? {\n      ...order,\n      products: order.products.map(p => ({\n        ...p,\n        isSelected: shouldSelectAll\n      }))\n    } : order));\n  };\n  const isAllSelected = currentOrder ? currentOrder.products.length > 0 && currentOrder.products.every(p => p.isSelected) : false;\n  const isSomeSelected = currentOrder ? currentOrder.products.some(p => p.isSelected) && !isAllSelected : false;\n  const handleCloseOrderTab = async (idToClose, options = {}) => {\n    // Gán giá trị mặc định cho returnStock\n    const {\n      returnStock = true\n    } = options;\n    const orderToClose = orders.find(order => order.id === idToClose);\n    if (!orderToClose) return;\n    try {\n      // CHỈ GỌI API KHI returnStock LÀ TRUE\n      if (returnStock && orderToClose.products.length > 0) {\n        console.log(`Đang hoàn trả sản phẩm cho đơn hàng ID: ${orderToClose.name}`);\n        const returnProductPromises = orderToClose.products.map(product => axios.put(`http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${product.idChiTietSanPham}`, null, {\n          params: {\n            soLuong: product.quantity\n          }\n        }));\n        await Promise.all(returnProductPromises);\n      } else {\n        console.log(`Đóng tab cho đơn hàng đã hoàn tất ID: ${orderToClose.name}. Không hoàn trả sản phẩm.`);\n      }\n\n      // Phần logic còn lại để đóng tab không thay đổi\n      const newOrders = orders.filter(order => order.id !== idToClose);\n      setOrders(newOrders);\n      if (selectedTab === idToClose) {\n        if (newOrders.length === 0) {\n          setSelectedTab(null);\n          // Tùy chọn: tự động tạo đơn hàng mới\n          // handleCreateOrder();\n        } else {\n          setSelectedTab(newOrders[0].id);\n        }\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi hoàn trả sản phẩm khi đóng tab:\", error);\n      toast.error(`Có lỗi xảy ra khi đóng đơn hàng. Sản phẩm chưa được hoàn trả về kho. Vui lòng thử lại.`);\n    }\n  };\n  useEffect(() => {\n    let today = new Date().getDate();\n\n    // Hàm thực hiện việc xóa tất cả các tab\n    const clearAllTabs = async () => {\n      console.log(\"🌅 Đã qua ngày mới, tiến hành xóa các tab chờ...\");\n      try {\n        // Lấy danh sách các đơn hàng đang chờ từ localStorage\n        const savedOrdersRaw = localStorage.getItem(\"salesOrders\");\n        const pendingOrders = savedOrdersRaw ? JSON.parse(savedOrdersRaw) : [];\n        if (pendingOrders.length > 0) {\n          // Tạo một mảng các promise để gọi API hoàn trả số lượng cho tất cả sản phẩm\n          const returnPromises = pendingOrders.flatMap(order => order.products.map(product => {\n            console.log(`Hoàn trả ${product.quantity} sản phẩm ${product.tenSanPham} về kho.`);\n            return axios.put(`http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${product.idChiTietSanPham}`, null, {\n              params: {\n                soLuong: product.quantity\n              }\n            });\n          }));\n\n          // Chờ tất cả các API hoàn trả thực hiện xong\n          await Promise.allSettled(returnPromises);\n          console.log(\"Hoàn trả số lượng tồn kho hoàn tất.\");\n        }\n\n        // Xóa dữ liệu trong localStorage\n        localStorage.removeItem(\"salesOrders\");\n        localStorage.removeItem(\"selectedSalesTab\");\n\n        // Hiển thị thông báo và tải lại trang để reset trạng thái\n        toast.success(\"Đã qua ngày mới, tất cả các đơn hàng chờ đã được dọn dẹp.\");\n        window.location.reload();\n      } catch (error) {\n        console.error(\"Lỗi khi tự động dọn dẹp các tab chờ:\", error);\n        alert(\"Có lỗi xảy ra trong quá trình dọn dẹp tự động.\");\n      }\n    };\n\n    // Thiết lập một bộ đếm thời gian kiểm tra mỗi phút\n    const intervalId = setInterval(() => {\n      const now = new Date();\n      // Nếu ngày hiện tại khác với ngày đã lưu -> tức là đã qua nửa đêm\n      if (now.getDate() !== today) {\n        // Cập nhật lại ngày \"hôm nay\"\n        today = now.getDate();\n        // Gọi hàm xóa\n        clearAllTabs();\n      }\n    }, 60000); // 60000ms = 1 phút\n\n    // Dọn dẹp interval khi component bị unmount\n    return () => clearInterval(intervalId);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(SoftBox, {\n        p: 2,\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            mb: 2\n          },\n          children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n            variant: \"h6\",\n            fontWeight: \"medium\",\n            children: \"H\\xF3a \\u0111\\u01A1n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"info\",\n            startIcon: /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 26\n            }, this),\n            onClick: handleCreateOrder,\n            disabled: orders.length >= MAX_ORDERS,\n            children: \"T\\u1EA1o \\u0111\\u01A1n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            borderBottom: 1,\n            borderColor: \"divider\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Tabs, {\n            value: selectedTab,\n            onChange: (e, val) => setSelectedTab(val),\n            variant: \"scrollable\",\n            scrollButtons: \"auto\",\n            sx: {\n              \"& .MuiTabs-flexContainer\": {\n                justifyContent: \"flex-start\"\n              }\n            },\n            children: orders.map(order => /*#__PURE__*/_jsxDEV(CustomTab, {\n              value: order.id,\n              label: /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: 2.5\n                },\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  children: [order.name, \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 554,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                  badgeContent: order.products.length,\n                  color: \"error\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 555,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(IconButton\n                // THÊM DÒNG NÀY ĐỂ SỬA LỖI\n                , {\n                  component: \"div\"\n                  // ------------------------\n                  ,\n                  size: \"small\",\n                  onClick: e => {\n                    e.stopPropagation();\n                    handleCloseOrderTab(order.id);\n                  },\n                  sx: {\n                    marginLeft: \"auto\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(CloseIcon, {\n                    fontSize: \"small\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 567,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 556,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 553,\n                columnNumber: 21\n              }, this)\n            }, order.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 549,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SoftBox, {\n          mt: 2,\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n              mb: 1,\n              py: 1.5,\n              borderBottom: \"1px solid #f0f2f5\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(SoftTypography, {\n              variant: \"h6\",\n              fontWeight: \"medium\",\n              color: \"text\",\n              children: \"\\u25A0 S\\u1EA3n ph\\u1EA9m\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                display: \"flex\",\n                gap: 1\n              },\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outlined\",\n                startIcon: /*#__PURE__*/_jsxDEV(QrCodeScannerIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 594,\n                  columnNumber: 30\n                }, this),\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                children: \"QU\\xC9T QR S\\u1EA2N PH\\u1EA8M\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 592,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outlined\",\n                startIcon: /*#__PURE__*/_jsxDEV(ShoppingCartIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 614,\n                  columnNumber: 30\n                }, this),\n                onClick: () => setIsProductModalOpen(true),\n                disabled: !selectedTab,\n                sx: {\n                  borderRadius: 2,\n                  textTransform: \"none\",\n                  fontWeight: 400,\n                  color: \"#49a3f1\",\n                  borderColor: \"#49a3f1\",\n                  boxShadow: \"none\",\n                  \"&:hover\": {\n                    borderColor: \"#1769aa\",\n                    background: \"#f0f6fd\",\n                    color: \"#1769aa\"\n                  }\n                },\n                children: \"TH\\xCAM S\\u1EA2N PH\\u1EA8M\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 612,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              minHeight: \"300px\",\n              display: \"flex\",\n              flexDirection: \"column\",\n              mt: 2\n            },\n            children: currentOrder ? currentOrder.products.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  px: 2,\n                  py: 1,\n                  borderBottom: \"2px solid #ddd\",\n                  backgroundColor: \"#f9f9f9\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    width: \"5%\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                    checked: isAllSelected,\n                    indeterminate: isSomeSelected,\n                    onChange: e => handleToggleAllProducts(e.target.checked)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 651,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 650,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    flex: 1\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"subtitle2\",\n                    fontWeight: \"bold\",\n                    children: \"S\\u1EA3n ph\\u1EA9m\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 658,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 657,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    width: \"15%\",\n                    display: \"flex\",\n                    justifyContent: \"center\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"subtitle2\",\n                    fontWeight: \"bold\",\n                    children: \"S\\u1ED1 l\\u01B0\\u1EE3ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 663,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 662,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    width: \"15%\",\n                    display: \"flex\",\n                    justifyContent: \"flex-end\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"subtitle2\",\n                    fontWeight: \"bold\",\n                    children: \"Th\\xE0nh ti\\u1EC1n\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 668,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 667,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    width: \"10%\",\n                    display: \"flex\",\n                    justifyContent: \"flex-end\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 672,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 640,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  flexGrow: 1,\n                  overflow: \"auto\",\n                  pr: 1\n                },\n                children: currentOrder.products.map(product => {\n                  var _product$giaTienSauKh;\n                  return (\n                    /*#__PURE__*/\n                    // BẮT ĐẦU THAY THẾ TỪ ĐÂY\n                    _jsxDEV(Box, {\n                      sx: {\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        py: 2,\n                        borderBottom: \"1px solid #f0f2f5\",\n                        opacity: product.isSelected ? 1 : 0.5,\n                        px: 2\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(Box, {\n                        sx: {\n                          width: \"5%\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                          checked: product.isSelected,\n                          onChange: () => handleToggleProductSelection(product.uniqueId)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 692,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 691,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Box, {\n                        sx: {\n                          flex: 1,\n                          display: \"flex\",\n                          alignItems: \"center\",\n                          gap: 2\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(Box, {\n                          sx: {\n                            position: \"relative\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(Avatar, {\n                            variant: \"rounded\",\n                            src: product.duongDanAnh,\n                            sx: {\n                              width: 60,\n                              height: 60\n                            }\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 703,\n                            columnNumber: 31\n                          }, this), product.phanTramGiam > 0 && /*#__PURE__*/_jsxDEV(Typography, {\n                            variant: \"caption\",\n                            color: \"white\",\n                            fontWeight: \"bold\",\n                            sx: {\n                              position: \"absolute\",\n                              top: 0,\n                              left: 0,\n                              backgroundColor: \"success.main\",\n                              // Màu xanh lá cây\n                              padding: \"2px 5px\",\n                              borderRadius: \"4px\",\n                              fontSize: \"0.7rem\",\n                              lineHeight: 1.2\n                            },\n                            children: [product.phanTramGiam, \"% OFF\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 710,\n                            columnNumber: 33\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 702,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(Box, {\n                          children: [/*#__PURE__*/_jsxDEV(Typography, {\n                            variant: \"subtitle1\",\n                            fontWeight: \"medium\",\n                            children: product.tenSanPham\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 732,\n                            columnNumber: 31\n                          }, this), product.phanTramGiam > 0 && product.giaTienSauKhiGiam < product.gia ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                            children: [/*#__PURE__*/_jsxDEV(Typography, {\n                              variant: \"body2\",\n                              color: \"text.secondary\",\n                              sx: {\n                                textDecoration: \"line-through\"\n                              },\n                              children: formatCurrency(product.gia)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 739,\n                              columnNumber: 35\n                            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                              variant: \"body1\",\n                              color: \"error.main\",\n                              fontWeight: \"bold\",\n                              children: formatCurrency(product.giaTienSauKhiGiam)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 746,\n                              columnNumber: 35\n                            }, this)]\n                          }, void 0, true) : /*#__PURE__*/_jsxDEV(Typography, {\n                            variant: \"body1\",\n                            color: \"text.primary\",\n                            fontWeight: \"bold\",\n                            children: formatCurrency(product.gia)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 751,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                            variant: \"body2\",\n                            color: \"text.secondary\",\n                            children: [\"M\\xE0u: \", product.mauSac, \" | Size: \", product.kichThuoc]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 756,\n                            columnNumber: 31\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 731,\n                          columnNumber: 29\n                        }, this), product.giaTruocKhiDoi && /*#__PURE__*/_jsxDEV(Typography, {\n                          variant: \"caption\",\n                          sx: {\n                            color: \"error.main\",\n                            // Màu đỏ\n                            fontStyle: \"italic\" // In nghiêng\n                          },\n                          children: [\"(Gi\\xE1 \\u0111\\xE3 \\u0111\\u1ED5i t\\u1EEB \", formatCurrency(product.giaTruocKhiDoi), \" th\\xE0nh\", \" \", formatCurrency((_product$giaTienSauKh = product.giaTienSauKhiGiam) !== null && _product$giaTienSauKh !== void 0 ? _product$giaTienSauKh : product.gia), \")\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 761,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 700,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Box, {\n                        sx: {\n                          width: \"15%\",\n                          display: \"flex\",\n                          justifyContent: \"center\",\n                          alignItems: \"center\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(Box, {\n                          sx: {\n                            display: \"flex\",\n                            flexDirection: \"column\",\n                            alignItems: \"center\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(Box, {\n                            sx: {\n                              display: \"flex\",\n                              alignItems: \"center\"\n                            },\n                            children: [/*#__PURE__*/_jsxDEV(IconButton, {\n                              size: \"small\",\n                              onClick: () => handleUpdateQuantity(product.uniqueId, product.quantity - 1),\n                              disabled: !!product.isPriceLocked || product.quantity <= 1,\n                              sx: {\n                                border: 1,\n                                borderColor: \"divider\",\n                                borderRadius: 2\n                              },\n                              children: /*#__PURE__*/_jsxDEV(RemoveIcon, {\n                                fontSize: \"small\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 799,\n                                columnNumber: 35\n                              }, this)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 791,\n                              columnNumber: 33\n                            }, this), /*#__PURE__*/_jsxDEV(TextField, {\n                              disabled: !!product.isPriceLocked,\n                              type: \"number\",\n                              value: product.quantity,\n                              onChange: e => {\n                                const value = parseInt(e.target.value, 10);\n                                if (e.target.value === \"\") {\n                                  handleUpdateQuantity(product.uniqueId, 0);\n                                } else if (isNaN(value) || value < 1) {\n                                  handleUpdateQuantity(product.uniqueId, 1);\n                                } else if (value > product.soLuongTonKho) {\n                                  handleUpdateQuantity(product.uniqueId, product.soLuongTonKho);\n                                } else {\n                                  handleUpdateQuantity(product.uniqueId, value);\n                                }\n                              },\n                              inputProps: {\n                                style: {\n                                  textAlign: \"center\"\n                                },\n                                min: 1,\n                                max: product.soLuongTonKho\n                              },\n                              sx: {\n                                width: \"70px\",\n                                mx: 1\n                              }\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 801,\n                              columnNumber: 33\n                            }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                              size: \"small\",\n                              onClick: () => handleUpdateQuantity(product.uniqueId, product.quantity + 1),\n                              disabled: !!product.isPriceLocked || product.quantity >= product.soLuongTonKho,\n                              sx: {\n                                border: 1,\n                                borderColor: \"divider\",\n                                borderRadius: 2\n                              },\n                              children: /*#__PURE__*/_jsxDEV(AddIcon, {\n                                fontSize: \"small\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 835,\n                                columnNumber: 35\n                              }, this)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 824,\n                              columnNumber: 33\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 790,\n                            columnNumber: 31\n                          }, this), product.quantity === product.soLuongTonKho && product.soLuongTonKho > 0 && /*#__PURE__*/_jsxDEV(Typography, {\n                            variant: \"caption\",\n                            color: \"error\",\n                            sx: {\n                              mt: 0.5,\n                              fontWeight: \"medium\"\n                            },\n                            children: \"\\u0110\\xE3 \\u0111\\u1EA1t gi\\u1EDBi h\\u1EA1n kho\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 840,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 783,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 775,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Box, {\n                        sx: {\n                          width: \"15%\",\n                          textAlign: \"right\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(Typography, {\n                          variant: \"h6\",\n                          fontWeight: \"bold\",\n                          children: formatCurrency((product.giaTienSauKhiGiam > 0 ? product.giaTienSauKhiGiam : product.gia) * product.quantity)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 853,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 852,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Box, {\n                        sx: {\n                          width: \"10%\",\n                          textAlign: \"right\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(IconButton, {\n                          color: \"error\",\n                          onClick: () => handleRemoveProduct(product.uniqueId),\n                          children: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 868,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 864,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 863,\n                        columnNumber: 27\n                      }, this)]\n                    }, product.uniqueId, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 679,\n                      columnNumber: 25\n                    }, this)\n                    // KẾT THÚC THAY THẾ TẠI ĐÂY\n                  );\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 676,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: \"flex\",\n                  justifyContent: \"flex-end\",\n                  alignItems: \"center\",\n                  mt: 2,\n                  pt: 2,\n                  borderTop: \"1px solid #ddd\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h6\",\n                  children: \"T\\u1ED5ng ti\\u1EC1n (c\\xE1c m\\u1EE5c \\u0111\\xE3 ch\\u1ECDn):\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 887,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h6\",\n                  color: \"error\",\n                  fontWeight: \"bold\",\n                  sx: {\n                    ml: 2,\n                    minWidth: \"180px\",\n                    textAlign: \"right\"\n                  },\n                  children: formatCurrency(totalAmount)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 888,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 877,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                m: \"auto\",\n                textAlign: \"center\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(ShoppingCartIcon, {\n                sx: {\n                  fontSize: \"3rem\",\n                  color: \"grey.400\",\n                  mb: 1\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 900,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(SoftTypography, {\n                variant: \"body2\",\n                color: \"text.secondary\",\n                children: \"Ch\\u01B0a c\\xF3 s\\u1EA3n ph\\u1EA9m trong \\u0111\\u01A1n h\\xE0ng n\\xE0y.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 901,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 899,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                m: \"auto\",\n                textAlign: \"center\"\n              },\n              children: /*#__PURE__*/_jsxDEV(SoftTypography, {\n                variant: \"h6\",\n                color: \"text.secondary\",\n                children: \"Vui l\\xF2ng ch\\u1ECDn ho\\u1EB7c t\\u1EA1o m\\u1ED9t \\u0111\\u01A1n h\\xE0ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 908,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 907,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 636,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {\n          sx: {\n            my: 3\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 916,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 512,\n      columnNumber: 7\n    }, this), isProductModalOpen && /*#__PURE__*/_jsxDEV(ProductSelectionModal, {\n      open: isProductModalOpen,\n      onClose: () => setIsProductModalOpen(false),\n      onSelectProduct: handleProductSelected\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 921,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(SalesCounter, \"zsl99e33dJ/3t/kswsOSKqdLRp4=\");\n_c2 = SalesCounter;\nSalesCounter.propTypes = {\n  onTotalChange: PropTypes.func,\n  onInvoiceIdChange: PropTypes.func.isRequired,\n  onProductsChange: PropTypes.func.isRequired,\n  completedOrderId: PropTypes.number\n};\nexport default SalesCounter;\nvar _c, _c2;\n$RefreshReg$(_c, \"CustomTab\");\n$RefreshReg$(_c2, \"SalesCounter\");","map":{"version":3,"names":["React","useState","useMemo","useEffect","axios","Box","Typography","Button","Tabs","Tab","IconButton","styled","Divider","TextField","Avatar","Checkbox","Badge","AddIcon","CloseIcon","ShoppingCartIcon","QrCodeScannerIcon","PersonSearchIcon","PaidIcon","DeleteIcon","RemoveIcon","SoftBox","Card","SoftTypography","ProductSelectionModal","PropTypes","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","formatCurrency","amount","isNaN","Intl","NumberFormat","style","currency","format","CustomTab","theme","flexDirection","textTransform","width","flexGrow","backgroundColor","justifyContent","color","_c","MAX_ORDERS","SalesCounter","onTotalChange","onInvoiceIdChange","onProductsChange","completedOrderId","_s","orderToClose","orders","find","o","idHoaDonBackend","handleCloseOrderTab","id","returnStock","setOrders","savedOrders","localStorage","getItem","JSON","parse","error","console","selectedTab","setSelectedTab","length","isProductModalOpen","setIsProductModalOpen","selectedCustomer","setSelectedCustomer","idKhachHang","sdt","ten","notes","setNotes","currentOrder","totalAmount","products","filter","product","isSelected","reduce","total","finalPrice","giaTienSauKhiGiam","gia","quantity","handleCreateOrder","currentInvoiceId","alert","response","post","loaiHoaDon","maHoaDon","data","nextId","Math","max","map","parseInt","newOrder","String","name","log","prev","handleUpdateOrder","danhSachCapNhat","p","idChiTietSanPham","soLuong","_error$response","_error$response$data","message","setItem","stringify","removeItem","handleProductSelected","productToAdd","sanitizedProduct","uniqueId","Date","now","parseFloat","prevOrders","order","existingProduct","reverse","isPriceLocked","updatedProducts","existingPrice","newPrice","campaignsAreSame","idDotGiamGia","newProductWithPriceChange","giaTruocKhiDoi","productsWithLockedOld","handleUpdateQuantity","productId","newQuantity","handleRemoveProduct","productToUpdate","oldQuantity","quantityChange","isIncreasingInCart","endpoint","put","params","abs","_error$response2","_error$response2$data","productToRemove","_error$response3","_error$response3$data","handleToggleProductSelection","handleToggleAllProducts","shouldSelectAll","isAllSelected","every","isSomeSelected","some","idToClose","options","returnProductPromises","Promise","all","newOrders","today","getDate","clearAllTabs","savedOrdersRaw","pendingOrders","returnPromises","flatMap","tenSanPham","allSettled","success","window","location","reload","intervalId","setInterval","clearInterval","children","sx","display","alignItems","mb","variant","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","startIcon","onClick","disabled","borderBottom","borderColor","value","onChange","e","val","scrollButtons","label","gap","badgeContent","component","size","stopPropagation","marginLeft","fontSize","mt","py","borderRadius","boxShadow","background","minHeight","px","checked","indeterminate","target","flex","overflow","pr","_product$giaTienSauKh","opacity","position","src","duongDanAnh","height","phanTramGiam","top","left","padding","lineHeight","textDecoration","mauSac","kichThuoc","fontStyle","border","type","soLuongTonKho","inputProps","textAlign","min","mx","pt","borderTop","ml","minWidth","m","my","open","onClose","onSelectProduct","_c2","propTypes","func","isRequired","number","$RefreshReg$"],"sources":["D:/fashion-shirt-shop/DATN/src/main/resources/templates/fashionshop-ui/src/layouts/admin/BanHangTaiQuay/component/SalesCounter.jsx"],"sourcesContent":["// src/layouts/sales/components/SalesCounter.jsx\n\nimport React, { useState, useMemo, useEffect } from \"react\";\nimport axios from \"axios\";\nimport {\n  Box,\n  Typography,\n  Button,\n  Tabs,\n  Tab,\n  IconButton,\n  styled,\n  Divider,\n  TextField,\n  Avatar,\n  Checkbox,\n  Badge,\n} from \"@mui/material\";\nimport AddIcon from \"@mui/icons-material/Add\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport ShoppingCartIcon from \"@mui/icons-material/ShoppingCart\";\nimport QrCodeScannerIcon from \"@mui/icons-material/QrCodeScanner\";\nimport PersonSearchIcon from \"@mui/icons-material/PersonSearch\";\nimport PaidIcon from \"@mui/icons-material/Paid\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\nimport RemoveIcon from \"@mui/icons-material/Remove\";\n\n// Import các component chung\nimport SoftBox from \"../../../../components/SoftBox\";\nimport Card from \"@mui/material/Card\";\nimport SoftTypography from \"../../../../components/SoftTypography\";\n\n// Import modal (điều chỉnh đường dẫn nếu cần)\nimport ProductSelectionModal from \"./ProductSelectionModal\";\nimport PropTypes from \"prop-types\";\nimport { toast } from \"react-toastify\";\n\nconst formatCurrency = (amount) => {\n  if (typeof amount !== \"number\" || isNaN(amount)) {\n    return \"N/A\";\n  }\n  return new Intl.NumberFormat(\"vi-VN\", { style: \"currency\", currency: \"VND\" }).format(amount);\n};\n\nconst CustomTab = styled(Tab)(({ theme }) => ({\n  flexDirection: \"row\",\n  textTransform: \"none\",\n  width: \"300px\",\n  flexGrow: 0,\n  \"&:hover\": {\n    backgroundColor: \"rgba(73, 163, 241, 0.1)\",\n  },\n  \"& .MuiTab-wrapper\": {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    width: \"100%\",\n  },\n  \"&.Mui-selected\": {\n    color: \"#ffff !important\",\n    backgroundColor: \"#49a3f1 !important\",\n  },\n}));\n\nconst MAX_ORDERS = 10;\n\nfunction SalesCounter({ onTotalChange, onInvoiceIdChange, onProductsChange, completedOrderId }) {\n  useEffect(() => {\n    // Nếu có tín hiệu (completedOrderId có giá trị và khác null)\n    if (completedOrderId) {\n      // Tìm order trong state `orders` tương ứng với ID hóa đơn đã hoàn thành từ backend\n      const orderToClose = orders.find((o) => o.idHoaDonBackend === completedOrderId);\n\n      // Nếu tìm thấy order, gọi hàm đóng tab với tùy chọn KHÔNG hoàn trả hàng\n      if (orderToClose) {\n        handleCloseOrderTab(orderToClose.id, { returnStock: false }); // <-- THAY ĐỔI Ở ĐÂY\n      }\n    }\n    // useEffect này sẽ chạy mỗi khi `completedOrderId` thay đổi\n  }, [completedOrderId]);\n\n  const [orders, setOrders] = useState(() => {\n    try {\n      const savedOrders = localStorage.getItem(\"salesOrders\");\n      return savedOrders ? JSON.parse(savedOrders) : [];\n    } catch (error) {\n      console.error(\"Lỗi khi đọc orders từ sessionStorage:\", error);\n      return [];\n    }\n  });\n  const [selectedTab, setSelectedTab] = useState(orders.length > 0 ? orders[0].id : null);\n  const [isProductModalOpen, setIsProductModalOpen] = useState(false);\n  const [selectedCustomer, setSelectedCustomer] = useState({\n    idKhachHang: 101,\n    sdt: \"012345673\",\n    ten: \"Khách lẻ\",\n  });\n  const [notes, setNotes] = useState(\"Khách thanh toán tiền mặt\");\n\n  const currentOrder = useMemo(\n    () => orders.find((o) => o.id === selectedTab),\n    [orders, selectedTab]\n  );\n\n  const totalAmount = useMemo(() => {\n    if (!currentOrder) return 0;\n    return currentOrder.products\n      .filter((product) => product.isSelected)\n      .reduce((total, product) => {\n        const finalPrice = product.giaTienSauKhiGiam > 0 ? product.giaTienSauKhiGiam : product.gia;\n        return total + finalPrice * product.quantity;\n      }, 0);\n  }, [currentOrder]);\n  // <<< THÊM useEffect ĐỂ GỬI totalAmount LÊN COMPONENT CHA\n  useEffect(() => {\n    // Mỗi khi totalAmount thay đổi, gọi hàm callback đã được truyền xuống\n    if (onTotalChange) {\n      onTotalChange(totalAmount);\n    }\n  }, [totalAmount, onTotalChange]);\n\n  useEffect(() => {\n    if (orders.length === 0) {\n      handleCreateOrder();\n    }\n  }, []);\n  useEffect(() => {\n    // Lấy ra id hóa đơn từ backend của order đang được chọn\n    const currentInvoiceId = currentOrder?.idHoaDonBackend;\n\n    // Nếu có hàm callback thì gọi nó với ID mới\n    if (onInvoiceIdChange) {\n      onInvoiceIdChange(currentInvoiceId);\n    }\n  }, [currentOrder, onInvoiceIdChange]);\n\n  const handleCreateOrder = async () => {\n    if (orders.length >= MAX_ORDERS) {\n      alert(`Chỉ có thể tạo tối đa ${MAX_ORDERS} đơn hàng.`);\n      return;\n    }\n    try {\n      const response = await axios.post(\"http://localhost:8080/api/hoa-don/tao-hoa-don-cho\", {\n        loaiHoaDon: \"Tại quầy\",\n      });\n\n      const { id: idHoaDonBackend, maHoaDon: maHoaDon } = response.data.data;\n\n      const nextId = (orders.length > 0 ? Math.max(...orders.map((o) => parseInt(o.id))) : 0) + 1;\n\n      const newOrder = {\n        id: String(nextId),\n        idHoaDonBackend: idHoaDonBackend,\n        name: maHoaDon || `Đơn hàng ${nextId}`,\n        products: [],\n      };\n      console.log(idHoaDonBackend);\n      setOrders((prev) => [...prev, newOrder]);\n      setSelectedTab(newOrder.id);\n    } catch (error) {\n      console.error(\"Lỗi khi tạo hóa đơn chờ:\", error);\n      alert(\"Lỗi khi tạo hóa đơn chờ. Vui lòng xem console.\");\n    }\n  };\n\n  const handleUpdateOrder = async () => {\n    if (!currentOrder || !currentOrder.idHoaDonBackend) {\n      alert(\"Vui lòng chọn một đơn hàng hợp lệ để cập nhật.\");\n      return;\n    }\n\n    const danhSachCapNhat = currentOrder.products.map((p) => ({\n      id: p.idChiTietSanPham,\n      soLuong: p.quantity,\n    }));\n\n    try {\n      await axios.post(\n        `http://localhost:8080/api/hoa-don/cap-nhat-danh-sach-san-pham/${currentOrder.idHoaDonBackend}`,\n        danhSachCapNhat\n      );\n      alert(\"Cập nhật đơn hàng thành công!\");\n    } catch (error) {\n      console.error(\"Lỗi khi cập nhật đơn hàng:\", error);\n      alert(`Lỗi khi cập nhật đơn hàng: ${error.response?.data?.message || \"Lỗi không xác định.\"}`);\n    }\n  };\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"salesOrders\", JSON.stringify(orders));\n      if (selectedTab) {\n        localStorage.setItem(\"selectedSalesTab\", selectedTab);\n      } else {\n        localStorage.removeItem(\"selectedSalesTab\");\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi lưu dữ liệu vào sessionStorage:\", error);\n    }\n  }, [orders, selectedTab]);\n\n  useEffect(() => {\n    if (onProductsChange) {\n      onProductsChange(currentOrder?.products || []);\n    }\n  }, [currentOrder, onProductsChange]);\n  const handleProductSelected = (productToAdd) => {\n     console.log(\"productToAdd:\", productToAdd); \n    const sanitizedProduct = {\n      ...productToAdd,\n      uniqueId: `${productToAdd.idChiTietSanPham}-${Date.now()}`, // Luôn tạo uniqueId\n      gia: parseFloat(productToAdd.gia) || 0,\n      giaTienSauKhiGiam: productToAdd.giaTienSauKhiGiam\n        ? parseFloat(productToAdd.giaTienSauKhiGiam)\n        : null,\n      quantity: parseInt(productToAdd.quantity, 10) || 1,\n      isSelected: true,\n    };\n    \n    setOrders((prevOrders) =>\n      prevOrders.map((order) => {\n        if (order.id === selectedTab) {\n          // Tìm sản phẩm đã có trong giỏ hàng\n          const existingProduct = [...order.products] // Sao chép mảng để không thay đổi mảng gốc\n            .reverse() // Đảo ngược mảng\n            .find(\n              (p) => p.idChiTietSanPham === sanitizedProduct.idChiTietSanPham && !p.isPriceLocked\n            );\n            \n          let updatedProducts;\n          if (!existingProduct) {\n            // TRƯỜNG HỢP 1: Sản phẩm chưa từng có trong giỏ -> Thêm mới bình thường\n            updatedProducts = [...order.products, sanitizedProduct];\n          } else {\n            const existingPrice =\n              existingProduct.giaTienSauKhiGiam > 0\n                ? existingProduct.giaTienSauKhiGiam\n                : existingProduct.gia;\n            const newPrice =\n              sanitizedProduct.giaTienSauKhiGiam > 0\n                ? sanitizedProduct.giaTienSauKhiGiam\n                : sanitizedProduct.gia;\n                 const campaignsAreSame = existingProduct.idDotGiamGia === sanitizedProduct.idDotGiamGia;\n            if (existingPrice === newPrice&& campaignsAreSame) {\n              // GIÁ KHÔNG ĐỔI -> Tăng số lượng của sản phẩm đã có\n              updatedProducts = order.products.map((p) =>\n                p.idChiTietSanPham === sanitizedProduct.idChiTietSanPham\n                  ? { ...p, quantity: p.quantity + sanitizedProduct.quantity }\n                  : p\n              );\n            } else {\n              // GIÁ THAY ĐỔI -> Thêm như một dòng mới và lưu lại giá cũ để hiển thị\n              const newProductWithPriceChange = {\n                ...sanitizedProduct,\n                giaTruocKhiDoi: existingPrice, // <-- Thêm thuộc tính mới\n              };\n              const productsWithLockedOld = order.products.map((p) =>\n                p.uniqueId === existingProduct.uniqueId\n                  ? { ...p, isPriceLocked: true } // <-- ĐÁNH DẤU SẢN PHẨM CŨ\n                  : p\n              );\n              updatedProducts = [...productsWithLockedOld, newProductWithPriceChange];\n            }\n          }\n          return { ...order, products: updatedProducts };\n        }\n\n        return order;\n      })\n    );\n    setIsProductModalOpen(false);\n  };\n\n  // src/layouts/sales/components/SalesCounter.jsx\n\n  const handleUpdateQuantity = async (productId, newQuantity) => {\n    // Nếu số lượng mới bằng 0 hoặc ít hơn, hãy xử lý việc xóa sản phẩm.\n    // Bạn cũng nên đảm bảo `handleRemoveProduct` gọi API để hoàn trả toàn bộ số lượng về kho.\n    if (newQuantity <= 0) {\n      handleRemoveProduct(productId);\n      return;\n    }\n\n    // Tìm sản phẩm hiện tại trong state để lấy số lượng cũ\n    const currentOrder = orders.find((o) => o.id === selectedTab);\n    if (!currentOrder) return;\n    const productToUpdate = currentOrder.products.find((p) => p.uniqueId === productId);\n    if (!productToUpdate) return;\n\n    const oldQuantity = productToUpdate.quantity;\n    const quantityChange = newQuantity - oldQuantity; // Tính toán sự thay đổi\n\n    // Nếu không có gì thay đổi thì không làm gì cả\n    if (quantityChange === 0) return;\n\n    // Xác định xem nên tăng hay giảm số lượng trong kho\n    const isIncreasingInCart = quantityChange > 0; // Số lượng trong giỏ hàng đang tăng lên?\n\n    // Dựa vào API bạn cung cấp, chúng ta sẽ có 2 endpoint\n    const endpoint = isIncreasingInCart\n      ? `/giam-so-luong-san-pham/${productToUpdate.idChiTietSanPham}` // Giảm tồn kho\n      : `/tang-so-luong-san-pham/${productToUpdate.idChiTietSanPham}`; // Tăng (hoàn trả) tồn kho\n\n    try {\n      // BƯỚC 1: GỌI API\n      // Gửi yêu cầu PUT với `soLuong` là giá trị thay đổi (luôn là số dương)\n      await axios.put(`http://localhost:8080/api/hoa-don${endpoint}`, null, {\n        // Truyền null cho body nếu không cần\n        params: {\n          soLuong: Math.abs(quantityChange),\n        },\n      });\n\n      // BƯỚC 2: NẾU API THÀNH CÔNG, CẬP NHẬT GIAO DIỆN\n      setOrders((prevOrders) =>\n        prevOrders.map((order) =>\n          order.id === selectedTab\n            ? {\n                ...order,\n                products: order.products.map((p) =>\n                  p.uniqueId === productId ? { ...p, quantity: newQuantity } : p\n                ),\n              }\n            : order\n        )\n      );\n    } catch (error) {\n      // BƯỚC 3: XỬ LÝ LỖI TỪ API\n      console.error(\"Lỗi khi cập nhật số lượng sản phẩm:\", error);\n      // Thông báo cho người dùng, ví dụ: \"Số lượng tồn kho không đủ\"\n      alert(`Lỗi: ${error.response?.data?.message || \"Không thể cập nhật số lượng.\"}`);\n    }\n  };\n\n  const handleRemoveProduct = async (productId) => {\n    // BƯỚC 1: TÌM SẢN PHẨM SẮP BỊ XÓA TRONG STATE HIỆN TẠI\n    const currentOrder = orders.find((o) => o.id === selectedTab);\n    if (!currentOrder) return; // Không tìm thấy đơn hàng hiện tại\n\n    const productToRemove = currentOrder.products.find((p) => p.uniqueId === productId);\n    if (!productToRemove) return;\n    try {\n      await axios.put(\n        `http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${productToRemove.idChiTietSanPham}`,\n        null,\n        {\n          params: {\n            soLuong: productToRemove.quantity,\n          },\n        }\n      );\n      setOrders((prevOrders) =>\n        prevOrders.map((order) =>\n          order.id === selectedTab\n            ? {\n                ...order,\n\n                products: order.products.filter((p) => p.uniqueId !== productId),\n              }\n            : order\n        )\n      );\n    } catch (error) {\n      console.error(\"Lỗi khi hoàn trả sản phẩm về kho:\", error);\n      alert(`Lỗi: ${error.response?.data?.message || \"Không thể xóa sản phẩm.\"}`);\n    }\n  };\n\n  const handleToggleProductSelection = (productId) => {\n    setOrders((prevOrders) =>\n      prevOrders.map((order) =>\n        order.id === selectedTab\n          ? {\n              ...order,\n              products: order.products.map((p) =>\n                p.uniqueId === productId ? { ...p, isSelected: !p.isSelected } : p\n              ),\n            }\n          : order\n      )\n    );\n  };\n\n  const handleToggleAllProducts = (shouldSelectAll) => {\n    setOrders((prevOrders) =>\n      prevOrders.map((order) =>\n        order.id === selectedTab\n          ? {\n              ...order,\n              products: order.products.map((p) => ({ ...p, isSelected: shouldSelectAll })),\n            }\n          : order\n      )\n    );\n  };\n\n  const isAllSelected = currentOrder\n    ? currentOrder.products.length > 0 && currentOrder.products.every((p) => p.isSelected)\n    : false;\n  const isSomeSelected = currentOrder\n    ? currentOrder.products.some((p) => p.isSelected) && !isAllSelected\n    : false;\n\n  const handleCloseOrderTab = async (idToClose, options = {}) => {\n    // Gán giá trị mặc định cho returnStock\n    const { returnStock = true } = options;\n\n    const orderToClose = orders.find((order) => order.id === idToClose);\n    if (!orderToClose) return;\n\n    try {\n      // CHỈ GỌI API KHI returnStock LÀ TRUE\n      if (returnStock && orderToClose.products.length > 0) {\n        console.log(`Đang hoàn trả sản phẩm cho đơn hàng ID: ${orderToClose.name}`);\n        const returnProductPromises = orderToClose.products.map((product) =>\n          axios.put(\n            `http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${product.idChiTietSanPham}`,\n            null,\n            {\n              params: {\n                soLuong: product.quantity,\n              },\n            }\n          )\n        );\n        await Promise.all(returnProductPromises);\n      } else {\n        console.log(\n          `Đóng tab cho đơn hàng đã hoàn tất ID: ${orderToClose.name}. Không hoàn trả sản phẩm.`\n        );\n      }\n\n      // Phần logic còn lại để đóng tab không thay đổi\n      const newOrders = orders.filter((order) => order.id !== idToClose);\n      setOrders(newOrders);\n\n      if (selectedTab === idToClose) {\n        if (newOrders.length === 0) {\n          setSelectedTab(null);\n          // Tùy chọn: tự động tạo đơn hàng mới\n          // handleCreateOrder();\n        } else {\n          setSelectedTab(newOrders[0].id);\n        }\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi hoàn trả sản phẩm khi đóng tab:\", error);\n      toast.error(\n        `Có lỗi xảy ra khi đóng đơn hàng. Sản phẩm chưa được hoàn trả về kho. Vui lòng thử lại.`\n      );\n    }\n  };\n  useEffect(() => {\n    let today = new Date().getDate();\n\n    // Hàm thực hiện việc xóa tất cả các tab\n    const clearAllTabs = async () => {\n      console.log(\"🌅 Đã qua ngày mới, tiến hành xóa các tab chờ...\");\n\n      try {\n        // Lấy danh sách các đơn hàng đang chờ từ localStorage\n        const savedOrdersRaw = localStorage.getItem(\"salesOrders\");\n        const pendingOrders = savedOrdersRaw ? JSON.parse(savedOrdersRaw) : [];\n\n        if (pendingOrders.length > 0) {\n          // Tạo một mảng các promise để gọi API hoàn trả số lượng cho tất cả sản phẩm\n          const returnPromises = pendingOrders.flatMap((order) =>\n            order.products.map((product) => {\n              console.log(`Hoàn trả ${product.quantity} sản phẩm ${product.tenSanPham} về kho.`);\n              return axios.put(\n                `http://localhost:8080/api/hoa-don/tang-so-luong-san-pham/${product.idChiTietSanPham}`,\n                null,\n                { params: { soLuong: product.quantity } }\n              );\n            })\n          );\n\n          // Chờ tất cả các API hoàn trả thực hiện xong\n          await Promise.allSettled(returnPromises);\n          console.log(\"Hoàn trả số lượng tồn kho hoàn tất.\");\n        }\n\n        // Xóa dữ liệu trong localStorage\n        localStorage.removeItem(\"salesOrders\");\n        localStorage.removeItem(\"selectedSalesTab\");\n\n        // Hiển thị thông báo và tải lại trang để reset trạng thái\n        toast.success(\"Đã qua ngày mới, tất cả các đơn hàng chờ đã được dọn dẹp.\");\n        window.location.reload();\n      } catch (error) {\n        console.error(\"Lỗi khi tự động dọn dẹp các tab chờ:\", error);\n        alert(\"Có lỗi xảy ra trong quá trình dọn dẹp tự động.\");\n      }\n    };\n\n    // Thiết lập một bộ đếm thời gian kiểm tra mỗi phút\n    const intervalId = setInterval(() => {\n      const now = new Date();\n      // Nếu ngày hiện tại khác với ngày đã lưu -> tức là đã qua nửa đêm\n      if (now.getDate() !== today) {\n        // Cập nhật lại ngày \"hôm nay\"\n        today = now.getDate();\n        // Gọi hàm xóa\n        clearAllTabs();\n      }\n    }, 60000); // 60000ms = 1 phút\n\n    // Dọn dẹp interval khi component bị unmount\n    return () => clearInterval(intervalId);\n  }, []);\n  return (\n    <>\n      <Card>\n        <SoftBox p={2}>\n          {/* ... Phần header và tabs ... */}\n          <Box\n            sx={{\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n              mb: 2,\n            }}\n          >\n            <SoftTypography variant=\"h6\" fontWeight=\"medium\">\n              Hóa đơn\n            </SoftTypography>\n            <Button\n              variant=\"contained\"\n              color=\"info\"\n              startIcon={<AddIcon />}\n              onClick={handleCreateOrder}\n              disabled={orders.length >= MAX_ORDERS}\n            >\n              Tạo đơn\n            </Button>\n          </Box>\n          <Box sx={{ borderBottom: 1, borderColor: \"divider\" }}>\n            <Tabs\n              value={selectedTab}\n              onChange={(e, val) => setSelectedTab(val)}\n              variant=\"scrollable\"\n              scrollButtons=\"auto\"\n              sx={{\n                \"& .MuiTabs-flexContainer\": {\n                  justifyContent: \"flex-start\",\n                },\n              }}\n            >\n              {orders.map((order) => (\n                <CustomTab\n                  key={order.id}\n                  value={order.id}\n                  label={\n                    <Box sx={{ display: \"flex\", alignItems: \"center\", gap: 2.5 }}>\n                      <Typography variant=\"body2\">{order.name} </Typography>\n                      <Badge badgeContent={order.products.length} color=\"error\" />\n                      <IconButton\n                        // THÊM DÒNG NÀY ĐỂ SỬA LỖI\n                        component=\"div\"\n                        // ------------------------\n                        size=\"small\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handleCloseOrderTab(order.id);\n                        }}\n                        sx={{ marginLeft: \"auto\" }}\n                      >\n                        <CloseIcon fontSize=\"small\" />\n                      </IconButton>\n                    </Box>\n                  }\n                />\n              ))}\n            </Tabs>\n          </Box>\n\n          {/* Phần Sản phẩm */}\n          <SoftBox mt={2}>\n            <Box\n              sx={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                mb: 1,\n                py: 1.5,\n                borderBottom: \"1px solid #f0f2f5\",\n              }}\n            >\n              <SoftTypography variant=\"h6\" fontWeight=\"medium\" color=\"text\">\n                ■ Sản phẩm\n              </SoftTypography>\n              <Box sx={{ display: \"flex\", gap: 1 }}>\n                <Button\n                  variant=\"outlined\"\n                  startIcon={<QrCodeScannerIcon />}\n                  sx={{\n                    borderRadius: 2,\n                    textTransform: \"none\",\n                    fontWeight: 400,\n                    color: \"#49a3f1\",\n                    borderColor: \"#49a3f1\",\n                    boxShadow: \"none\",\n                    \"&:hover\": {\n                      borderColor: \"#1769aa\",\n                      background: \"#f0f6fd\",\n                      color: \"#1769aa\",\n                    },\n                  }}\n                >\n                  QUÉT QR SẢN PHẨM\n                </Button>\n\n                <Button\n                  variant=\"outlined\"\n                  startIcon={<ShoppingCartIcon />}\n                  onClick={() => setIsProductModalOpen(true)}\n                  disabled={!selectedTab}\n                  sx={{\n                    borderRadius: 2,\n                    textTransform: \"none\",\n                    fontWeight: 400,\n                    color: \"#49a3f1\",\n                    borderColor: \"#49a3f1\",\n                    boxShadow: \"none\",\n                    \"&:hover\": {\n                      borderColor: \"#1769aa\",\n                      background: \"#f0f6fd\",\n                      color: \"#1769aa\",\n                    },\n                  }}\n                >\n                  THÊM SẢN PHẨM\n                </Button>\n              </Box>\n            </Box>\n\n            <Box sx={{ minHeight: \"300px\", display: \"flex\", flexDirection: \"column\", mt: 2 }}>\n              {currentOrder ? (\n                currentOrder.products.length > 0 ? (\n                  <>\n                    <Box\n                      sx={{\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        px: 2,\n                        py: 1,\n                        borderBottom: \"2px solid #ddd\",\n                        backgroundColor: \"#f9f9f9\",\n                      }}\n                    >\n                      <Box sx={{ width: \"5%\" }}>\n                        <Checkbox\n                          checked={isAllSelected}\n                          indeterminate={isSomeSelected}\n                          onChange={(e) => handleToggleAllProducts(e.target.checked)}\n                        />\n                      </Box>\n                      <Box sx={{ flex: 1 }}>\n                        <Typography variant=\"subtitle2\" fontWeight=\"bold\">\n                          Sản phẩm\n                        </Typography>\n                      </Box>\n                      <Box sx={{ width: \"15%\", display: \"flex\", justifyContent: \"center\" }}>\n                        <Typography variant=\"subtitle2\" fontWeight=\"bold\">\n                          Số lượng\n                        </Typography>\n                      </Box>\n                      <Box sx={{ width: \"15%\", display: \"flex\", justifyContent: \"flex-end\" }}>\n                        <Typography variant=\"subtitle2\" fontWeight=\"bold\">\n                          Thành tiền\n                        </Typography>\n                      </Box>\n                      <Box sx={{ width: \"10%\", display: \"flex\", justifyContent: \"flex-end\" }} />\n                    </Box>\n\n                    {/* Danh sách sản phẩm */}\n                    <Box sx={{ flexGrow: 1, overflow: \"auto\", pr: 1 }}>\n                      {currentOrder.products.map((product) => (\n                        // BẮT ĐẦU THAY THẾ TỪ ĐÂY\n                        <Box\n                          key={product.uniqueId}\n                          sx={{\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            py: 2,\n                            borderBottom: \"1px solid #f0f2f5\",\n                            opacity: product.isSelected ? 1 : 0.5,\n                            px: 2,\n                          }}\n                        >\n                          {/* Cột 1: Checkbox */}\n                          <Box sx={{ width: \"5%\" }}>\n                            <Checkbox\n                              checked={product.isSelected}\n                              onChange={() => handleToggleProductSelection(product.uniqueId)}\n                            />\n                          </Box>\n\n                          {/* Cột 2: Thông tin sản phẩm ĐÃ CẬP NHẬT */}\n                          {/* Cột 2: Thông tin sản phẩm ĐÃ CẬP NHẬT HOÀN CHỈNH */}\n                          <Box sx={{ flex: 1, display: \"flex\", alignItems: \"center\", gap: 2 }}>\n                            {/* ===== CONTAINER MỚI CHO ẢNH VÀ NHÃN ===== */}\n                            <Box sx={{ position: \"relative\" }}>\n                              <Avatar\n                                variant=\"rounded\"\n                                src={product.duongDanAnh}\n                                sx={{ width: 60, height: 60 }}\n                              />\n                              {/* Nhãn giảm giá */}\n                              {product.phanTramGiam > 0 && (\n                                <Typography\n                                  variant=\"caption\"\n                                  color=\"white\"\n                                  fontWeight=\"bold\"\n                                  sx={{\n                                    position: \"absolute\",\n                                    top: 0,\n                                    left: 0,\n                                    backgroundColor: \"success.main\", // Màu xanh lá cây\n                                    padding: \"2px 5px\",\n                                    borderRadius: \"4px\",\n                                    fontSize: \"0.7rem\",\n                                    lineHeight: 1.2,\n                                  }}\n                                >\n                                  {product.phanTramGiam}% OFF\n                                </Typography>\n                              )}\n                            </Box>\n                            {/* ============================================== */}\n\n                            <Box>\n                              <Typography variant=\"subtitle1\" fontWeight=\"medium\">\n                                {product.tenSanPham}\n                              </Typography>\n\n                              {product.phanTramGiam > 0 &&\n                              product.giaTienSauKhiGiam < product.gia ? (\n                                <>\n                                  <Typography\n                                    variant=\"body2\"\n                                    color=\"text.secondary\"\n                                    sx={{ textDecoration: \"line-through\" }}\n                                  >\n                                    {formatCurrency(product.gia)}\n                                  </Typography>\n                                  <Typography variant=\"body1\" color=\"error.main\" fontWeight=\"bold\">\n                                    {formatCurrency(product.giaTienSauKhiGiam)}\n                                  </Typography>\n                                </>\n                              ) : (\n                                <Typography variant=\"body1\" color=\"text.primary\" fontWeight=\"bold\">\n                                  {formatCurrency(product.gia)}\n                                </Typography>\n                              )}\n\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                Màu: {product.mauSac} | Size: {product.kichThuoc}\n                              </Typography>\n                            </Box>\n                            {product.giaTruocKhiDoi && (\n                              <Typography\n                                variant=\"caption\"\n                                sx={{\n                                  color: \"error.main\", // Màu đỏ\n                                  fontStyle: \"italic\", // In nghiêng\n                                }}\n                              >\n                                (Giá đã đổi từ {formatCurrency(product.giaTruocKhiDoi)} thành{\" \"}\n                                {formatCurrency(product.giaTienSauKhiGiam ?? product.gia)})\n                              </Typography>\n                            )}\n                          </Box>\n\n                          {/* Cột 3: Số lượng */}\n                          <Box\n                            sx={{\n                              width: \"15%\",\n                              display: \"flex\",\n                              justifyContent: \"center\",\n                              alignItems: \"center\",\n                            }}\n                          >\n                            <Box\n                              sx={{\n                                display: \"flex\",\n                                flexDirection: \"column\",\n                                alignItems: \"center\",\n                              }}\n                            >\n                              <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\n                                <IconButton\n                                  size=\"small\"\n                                  onClick={() =>\n                                    handleUpdateQuantity(product.uniqueId, product.quantity - 1)\n                                  }\n                                  disabled={!!product.isPriceLocked || product.quantity <= 1}\n                                  sx={{ border: 1, borderColor: \"divider\", borderRadius: 2 }}\n                                >\n                                  <RemoveIcon fontSize=\"small\" />\n                                </IconButton>\n                                <TextField\n                                  disabled={!!product.isPriceLocked}\n                                  type=\"number\"\n                                  value={product.quantity}\n                                  onChange={(e) => {\n                                    const value = parseInt(e.target.value, 10);\n                                    if (e.target.value === \"\") {\n                                      handleUpdateQuantity(product.uniqueId, 0);\n                                    } else if (isNaN(value) || value < 1) {\n                                      handleUpdateQuantity(product.uniqueId, 1);\n                                    } else if (value > product.soLuongTonKho) {\n                                      handleUpdateQuantity(product.uniqueId, product.soLuongTonKho);\n                                    } else {\n                                      handleUpdateQuantity(product.uniqueId, value);\n                                    }\n                                  }}\n                                  inputProps={{\n                                    style: { textAlign: \"center\" },\n                                    min: 1,\n                                    max: product.soLuongTonKho,\n                                  }}\n                                  sx={{ width: \"70px\", mx: 1 }}\n                                />\n                                <IconButton\n                                  size=\"small\"\n                                  onClick={() =>\n                                    handleUpdateQuantity(product.uniqueId, product.quantity + 1)\n                                  }\n                                  disabled={\n                                    !!product.isPriceLocked ||\n                                    product.quantity >= product.soLuongTonKho\n                                  }\n                                  sx={{ border: 1, borderColor: \"divider\", borderRadius: 2 }}\n                                >\n                                  <AddIcon fontSize=\"small\" />\n                                </IconButton>\n                              </Box>\n                              {product.quantity === product.soLuongTonKho &&\n                                product.soLuongTonKho > 0 && (\n                                  <Typography\n                                    variant=\"caption\"\n                                    color=\"error\"\n                                    sx={{ mt: 0.5, fontWeight: \"medium\" }}\n                                  >\n                                    Đã đạt giới hạn kho\n                                  </Typography>\n                                )}\n                            </Box>\n                          </Box>\n\n                          {/* Cột 4: Thành tiền ĐÃ CẬP NHẬT */}\n                          <Box sx={{ width: \"15%\", textAlign: \"right\" }}>\n                            <Typography variant=\"h6\" fontWeight=\"bold\">\n                              {formatCurrency(\n                                (product.giaTienSauKhiGiam > 0\n                                  ? product.giaTienSauKhiGiam\n                                  : product.gia) * product.quantity\n                              )}\n                            </Typography>\n                          </Box>\n\n                          {/* Cột 5: Nút xóa */}\n                          <Box sx={{ width: \"10%\", textAlign: \"right\" }}>\n                            <IconButton\n                              color=\"error\"\n                              onClick={() => handleRemoveProduct(product.uniqueId)}\n                            >\n                              <DeleteIcon />\n                            </IconButton>\n                          </Box>\n                        </Box>\n                        // KẾT THÚC THAY THẾ TẠI ĐÂY\n                      ))}\n                    </Box>\n\n                    {/* Phần tổng tiền và thanh toán */}\n                    <Box\n                      sx={{\n                        display: \"flex\",\n                        justifyContent: \"flex-end\",\n                        alignItems: \"center\",\n                        mt: 2,\n                        pt: 2,\n                        borderTop: \"1px solid #ddd\",\n                      }}\n                    >\n                      <Typography variant=\"h6\">Tổng tiền (các mục đã chọn):</Typography>\n                      <Typography\n                        variant=\"h6\"\n                        color=\"error\"\n                        fontWeight=\"bold\"\n                        sx={{ ml: 2, minWidth: \"180px\", textAlign: \"right\" }}\n                      >\n                        {formatCurrency(totalAmount)}\n                      </Typography>\n                    </Box>\n                  </>\n                ) : (\n                  <Box sx={{ m: \"auto\", textAlign: \"center\" }}>\n                    <ShoppingCartIcon sx={{ fontSize: \"3rem\", color: \"grey.400\", mb: 1 }} />\n                    <SoftTypography variant=\"body2\" color=\"text.secondary\">\n                      Chưa có sản phẩm trong đơn hàng này.\n                    </SoftTypography>\n                  </Box>\n                )\n              ) : (\n                <Box sx={{ m: \"auto\", textAlign: \"center\" }}>\n                  <SoftTypography variant=\"h6\" color=\"text.secondary\">\n                    Vui lòng chọn hoặc tạo một đơn hàng\n                  </SoftTypography>\n                </Box>\n              )}\n            </Box>\n          </SoftBox>\n\n          <Divider sx={{ my: 3 }} />\n        </SoftBox>\n      </Card>\n      {/* Modal chọn sản phẩm */}\n      {isProductModalOpen && (\n        <ProductSelectionModal\n          open={isProductModalOpen}\n          onClose={() => setIsProductModalOpen(false)}\n          onSelectProduct={handleProductSelected}\n        />\n      )}\n    </>\n  );\n}\n\nSalesCounter.propTypes = {\n  onTotalChange: PropTypes.func,\n  onInvoiceIdChange: PropTypes.func.isRequired,\n  onProductsChange: PropTypes.func.isRequired,\n  completedOrderId: PropTypes.number,\n};\n\nexport default SalesCounter;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}